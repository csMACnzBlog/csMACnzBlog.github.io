<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>silverlight on csMACnz&#39;s Blog</title>
    <link>https://csmacnzblog.github.io/categories/silverlight/</link>
    <description>Recent content in silverlight on csMACnz&#39;s Blog</description>
    <image>
      <url>https://csmacnzblog.github.io/favicon.png</url>
      <title>csMACnz&#39;s Blog</title>
      <link>https://csmacnzblog.github.io</link>
    </image>
    <ttl>1440</ttl>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-nz</language>
    <lastBuildDate>Wed, 16 Feb 2011 04:38:14 +0000</lastBuildDate><atom:link href="https://csmacnzblog.github.io/categories/silverlight/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Bing Maps Control Series - 2: Add a simple map to your application</title>
      <link>https://csmacnzblog.github.io/post/bing-maps-control-series-2-add-a-simple-map-to-your-application/</link>
      <pubDate>Wed, 16 Feb 2011 04:38:14 +0000</pubDate>
      
      <guid>https://csmacnzblog.github.io/post/bing-maps-control-series-2-add-a-simple-map-to-your-application/</guid>
      <description><p>This is part 2 of a series on using the Silverlight Bing Maps Control. If haven&rsquo;t already, check out <a href="http://www.csmac.co.nz/blog/2011/01/17/bing-maps-control-series-1-downloading-and-installing-the-tools/">part 1</a>.</p>
<p>So Now that you have installed the Bing Maps Silverlight Control, and got yourself a key, you need to add the control to your project. For completeness, lets start by creating a new Silverlight 4 Application Project in Visual Studio 2010, and open up the MainPage.xaml file.</p>
<p>Now before we can add the control, we need a reference to it. If you installed to the default location, go the the solution explorer, right click on the References -&gt; Add Reference. Browse to <code>C:/Program Files(x86)/Bing Maps Silverlight Control/V1/Libraries</code> (or similar) and add the two Dlls, <code>Microsoft.Maps.MapControl.dll</code> and <code>Microsoft.Maps.MapControl.Common.dll</code>. Now we are ready to add the control. Now use the following code to add the map control to your xaml: <code>&lt;m:Map CredentialsProvider=&quot;[your key here]&quot;/&gt;</code> as well as adding this to your UserControl: <code>xmlns:m=&quot;clr-namespace:Microsoft.Maps.MapControl;assembly=Microsoft.Maps.MapControl&quot;</code> and your done!</p>
<p><img src="http://res.cloudinary.com/csmacnz/image/upload/h_185,w_300/v1414277577/bingscreenshot_arxohi.png" alt="Adding bing maps to silverlight" title="bingscreenshot"></p>
<p>Just be sure to replace <code>[your key here]</code> with the actual key from the last tutorial. Seriously, its that easy to create the simplest Bing Maps Silverlight app. The next step is to make it more interesting, customise it at a bit, and make it more useful.</p>
<p>For more information on creating simple Bing maps in Silverlight (and where I got most of this tutorial info from, what little there is :p ) check out this <a href="http://msdn.microsoft.com/en-us/library/ee681903.aspx">msdn article</a>.</p>
</description>
    </item>
    
    <item>
      <title>Bing Maps Control Series - 1: Downloading and Installing the Tools</title>
      <link>https://csmacnzblog.github.io/post/bing-maps-control-series-1-downloading-and-installing-the-tools/</link>
      <pubDate>Sun, 16 Jan 2011 19:29:10 +0000</pubDate>
      
      <guid>https://csmacnzblog.github.io/post/bing-maps-control-series-1-downloading-and-installing-the-tools/</guid>
      <description><p><a href="http://www.csmac.co.nz/blog/wp-content/uploads/2011/01/bingmapsscreen.png"><img src="http://res.cloudinary.com/csmacnz/image/upload/h_175,w_300/v1414277587/bingmapsscreen_gw6hxl.png" alt="Screenshot of Bing Maps." title="bingmapsscreen"></a></p>
<p>Over the last month or so I have has the opportunity to develop using the Bing Maps Control for Silverlight, and thought it appropriate to share this experience as well as a bit of a &lsquo;how to&rsquo; on using it. I plan for this to be a bit of a series based on the following items: - Downloading and Installing the Tools.</p>
<ul>
<li>Add a Simple map to your application.</li>
<li>Using Bing Services</li>
<li>Customising the Map Control</li>
<li>Using Custom MapTileSources</li>
</ul>
<p>Hopefully I will cover these off over the next few weeks. So to begin, lets start with the Downloading and Installing all the required files and tools.</p>
<p>I will assume you already have Visual Studio 2010 Full or <a href="http://www.microsoft.com/express/Windows/">Express</a>, and have installed the <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=b3deb194-ca86-4fb6-a716-b67c2604a139&amp;displaylang=en">Silverlight Tools </a>.</p>
<p>If you just want a quick preview of what is possible and what the control can do, or just feel liking playing with the bing maps control, head to the <a href="http://www.bing.com/maps/explore/">Bing Maps Website</a> and play around with the Silverlight version (not the javascript one), and check out a few of the Map Apps. Everything you see there is achievable with the Maps Control, some of it just requires more work than others. For a more developer centric view of this control, and some code samples and such, check out the <a href="http://www.microsoft.com/maps/isdk/silverlight/">Bing Maps Silverlight Control Interactive SDK</a>, which is similar to the <a href="https://www.silverlight.net/content/samples/sl4/toolkitcontrolsamples/run/default.html">Silverlight Toolkit Demo</a>. Both support Out-Of-Browser installation for convenience.  This is a great way to familiarise yourself with what this control can do.</p>
<p>To install the control, head to the <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=beb29d27-6f0c-494f-b028-1e0e3187e830&amp;displaylang=en">microsoft download page</a> to download the Bing Maps Silverlight control installer. Run this and follow the instructions to install. This gives you the required dlls as well as as some documentation in the form of a chm file. To use the Bing Maps Control, you need to provide it with a key. This key is an identifier for your application, and allows for tracking usage. Without a valid key, your control wont function.</p>
<p>First things first, create a Bing Maps Developer Account. Head to the Bing Maps Account Center at <a href="https://www.bingmapsportal.com/">https://www.bingmapsportal.com</a>. Simply click the Create button to create a new Windows Live User. If you already have a windows live account, use the Login button instead. Follow the instructions to create an account, entering all the required information. After entering your account details such as name and email, and accept the Terms of use. Once all that stuff is out of the way, you can create a new key using the <code>Create or view keys</code> Task on the left menu. Enter the details and follow instructions to produce your shiny new app key for your map. I would suggest using the Developer or Evaluation/Trial Application Type for the purposes of following this series, or else whichever options suit your purposes best. This key will help record the usage of your control which can be monitored and reported on using the Usage Reports. There is more information on this <a href="http://msdn.microsoft.com/en-us/library/ff859477.aspx">here</a>.</p>
<p>So thats everything we need to set up to get started on using the Control! For more information about the Bing Maps Silverlight Control, check out the <a href="http://msdn.microsoft.com/en-us/library/ee681884.aspx">documentation</a> online, specifically the pages for <a href="http://msdn.microsoft.com/en-us/library/ff428642.aspx">getting a key</a>, and information about <a href="http://msdn.microsoft.com/en-us/library/ee681900.aspx">using the key</a>.</p>
<p>Next I will go over using your newly downloaded control and key to add a Bing Map to your Silverlight application.</p>
</description>
    </item>
    
    <item>
      <title>Custom Control Validation in Silverlight</title>
      <link>https://csmacnzblog.github.io/post/custom-control-validation-in-silverlight/</link>
      <pubDate>Wed, 17 Nov 2010 20:52:11 +0000</pubDate>
      
      <guid>https://csmacnzblog.github.io/post/custom-control-validation-in-silverlight/</guid>
      <description><p>So you&rsquo;ve built up your nice new fancy custom control, and some Dependency Properties for your users to bind there data to, what else could you want? How about validation? Turns out that the control base class is all ready set up for this exact scenario. There is only one step required: Create the Visual states. Just add a visualstategroup called <code>ValidationStates</code> and a state for each of <code>Valid</code>, <code>InvalidUnfocused</code> and <code>InvalidFocused</code> corresponding to how you want your control to behave when in each of those states. You can even add these attributes into your class cs file to aid in blending your control:</p>
<pre><code class="language-cs">[TemplateVisualState(GroupName = &quot;ValidationStates&quot;, Name = &quot;Valid&quot;)]`
[TemplateVisualState(GroupName = &quot;ValidationStates&quot;, Name = &quot;InvalidUnfocused&quot;)]
[TemplateVisualState(GroupName = &quot;ValidationStates&quot;, Name = &quot;InvalidFocused&quot;)]
</code></pre>
<p>I suggest checking out how some of your favourite controls are templated for validation, such as CheckBox and TextBox, to build a default template that would fit in with the existing control validation states. This supports Exception Validation, <code>IDataErrorInfo</code>, <code>INotifyDataErrorInfo</code> including using <code>INotifyDataErrorInfo</code> asynchronously. Of course you need to set up your bindings correctly using the <code>ValidatesOnExceptions=true</code>, <code>NotifyOnValidationError=true</code> binding properties.</p>
<p>One quick Gotcha, that I found when testing this: make sure that you are binding on the property that reports the errors, especially when using the <code>INotifydataErrorInfo</code>. You need to explicitly bind the datacontext to your validation object to get class level validation to trigger the control&rsquo;s validation. This may be true for textboxes and other built-in controls as well, but I haven&rsquo;t verified this theory yet.</p>
<p>There is an excellent Whitepaper on validation using <code>INotifyDataErrorInfo</code> at <a href="http://www.silverlight.net/learn/whitepapers/introducing-new-inotifydataerrorinfo-interface/">silverlight.net/learn/whitepapers</a> as well as lots of posts around the web, if you take the time to look (or search). Jesse Liberty also has a <a href="http://jesseliberty.com/2010/07/25/data-validation-and-templating/">validation blog</a> as part of a templates and visual states series on his blog, which i referred to when building up my own validation controls and viewmodels using <code>INotifyDataErrorInfo</code>.</p>
</description>
    </item>
    
    <item>
      <title>WPF VS Silverlight 1: Data Template Selector</title>
      <link>https://csmacnzblog.github.io/post/wpf-vs-silverlight-1-data-template-selector/</link>
      <pubDate>Wed, 06 Oct 2010 03:44:12 +0000</pubDate>
      
      <guid>https://csmacnzblog.github.io/post/wpf-vs-silverlight-1-data-template-selector/</guid>
      <description><p>Here is my first post on what I will try and turn into a series of WPF/Silverlight differences and how to get around them.  First I will begin by talking about <code>DataTemplateSelector</code>.</p>
<p>I suppose before I talk about the <code>DataTemplateSelector</code> class, I should mention a little bit about what a Template is.  Unless you are new to WPF and Silverlight Development (and by extension, WP7 development) you will be aware all controls have a Template Property.  This property is of type <code>ControlTemplate</code>, and allows you to change the look and behaviour of a control, without affecting it&rsquo;s behaviour.   ContentControl which derives from Control has a Content field which holds an object. This object gets its look and feel from somewhere, and if it is a UIElement, then it comes from itself.  But if the object is some other type, such as a POCO or ViewModel object, then the default behaviour is to use the object&rsquo;s <code>ToString()</code> method.  Most of you have probably seen this numerous times and this is where the DataTemplate comes in.</p>
<p>ContentControl has another property called <code>ContentTemplate</code>, of type <code>DataTemplate</code>, that will be used in place of the content.  By default, the DataContext of the Template will be the Content property of the ContentControl. The benefit of this is that we can apply Bindings to get at the properties of the object itself. This finally brings me to the differences section of this post, The <code>DataTemplateSelector</code>. Up to this point, we are describing both Silverlight and WPF, but the <code>ContentTemplateSelector</code> Property of type <code>DataTemplateSelector</code> only exists on the WPF version of the <code>ContentControl</code> Class. So before I tell you how to overcome this, I will convince you of why you would bother using this feature anyway.</p>
<p><code>DataTemplateSelector</code> is a nice little class that has an overridable method called SelectTemplate which takes an item(the Content object) and a container(the Data-Bound Object, in this case the ContentControl) and returns a DataTemplate. By overriding this class we can create some logic that determines which DataTemplate is used based on some conditions at the time of it&rsquo;s use.  This could be a property of the item, such as an enum or boolean field, the type of the object, or something more complex. Basically you write the logic and return the right DataTemplate.</p>
<p>For a simple example of how this works, check out this page which demonstrates using text and image file names for selecting the DataTemplate. <a href="http://www.switchonthecode.com/tutorials/wpf-tutorial-how-to-use-a-datatemplateselector">how-to-use-a-datatemplateselector</a></p>
<p>Its also worth mentioning that the ItemsControl class (and therefore it&rsquo;s derived types such as ListBox) also have an <code>ItemTemplateSelector</code> which is a <code>DataTemplateSelector</code>, and can be used to give a different dataTemplate to different items in a collection, bound or set to the ItemsControl&rsquo;s Items.</p>
<p>So I&rsquo;m sure you can start to see some places where this might be useful, but what about Silverlight? Fortunately there is a solution. Converters.</p>
<p>By using some little tricks, we can use a Converter and a ContentControl and bind our object that needs a template to the Content Property of our ContentControl using a <code>DataTemplateSelectorConverter</code>.</p>
<p>For a simple implementation of the <code>DataTemplateSelectorConverter</code>, check out this posting. <a href="http://garfoot.com/blog/2010/03/flexible-data-template-support-in-silverlight/">Data Template Selector for Silverlight</a></p>
<p>I have made a few adjustments to this design, but I will save that for a later post. For now, this is one difference determined, and luckily a solution found.  I will try to add a real example of using the selector for both Silverlight and WPF in a future post.</p>
</description>
    </item>
    
    <item>
      <title>Where can I find Silverlight?</title>
      <link>https://csmacnzblog.github.io/post/where-can-i-find-silverlight/</link>
      <pubDate>Mon, 26 Apr 2010 09:23:24 +0000</pubDate>
      
      <guid>https://csmacnzblog.github.io/post/where-can-i-find-silverlight/</guid>
      <description><p>I had someone ask me the other day where he could go to see silverlight in action, what sites are using silverlight, so I did a bit of searching, and found that it&rsquo;s not that easy to find really. So here is my attempt to create such a list. Feel free to add anything I miss by posting comments.</p>
<h3 id="bing-maps">Bing maps</h3>
<p>I mentioned Twitter Maps on Bing in an <a href="http://www.csmac.co.nz/blog/2010/03/31/bing-presents-twitter-maps/" title="Bing Presents Twitter Maps">earlier post</a> but Bing maps is actually powered by silverlight, in its most advanced version. A standard version is available for those who don&rsquo;t have silverlight installed, but I did notice that the site makes a point to tell you that you get a better experience with Silverlight, and prompts you to install it. <a href="http://www.bing.com/maps/explore/#5003/0.40326=&amp;o=&amp;a=0/5872/style=auto&amp;lat=-41.287971&amp;lon=174.824121&amp;z=11&amp;pid=5874" title="Bing Maps Wellington Tweets">Bing Maps</a></p>
<h3 id="hard-rock-cafe">Hard Rock Cafe</h3>
<p>This is a nice use of the deep zoom control introduced in Silverlight version 2. As someone personally interested in music, especially guitar, I found this one very interesting, showing memorabilia from around the world. <a href="http://memorabilia.hardrock.com/" title="Hard Rock Cafe">Hard Rock Cafe</a></p>
<h3 id="michael-butterworth-photographer">Michael Butterworth Photographer</h3>
<p>Another use of deep zoom. Not alot else to mention about this one really. <a href="http://www.butterworth.me.uk/clientbin/deepzoom.htm" title="Michael Butterworth Photographer">Michael Butterworth Photographer</a></p>
<h3 id="falt-und-klapprad">Falt und Klapprad</h3>
<p>More deep zoom. This time for a bike shop. <a href="http://www.faltundklapprad.de/silverlight.aspx" title="Falt und Klapprad">Falt und Klapprad</a></p>
<h3 id="birmingham-museums--art-gallery">Birmingham Museums &amp; Art Gallery</h3>
<p>This is a nice use of deep zoom to display famous art pieces, especially allowing the ability to view a painting closer and in more detail then perhaps could be achieved at the art gallery. <a href="http://www.preraphaelites.org/personal-collections/zoom/37/exceptional-colour/" title="Birmingham Museum &amp; Art Gallery">Birmingham Museums &amp; Art Gallery</a></p>
<h3 id="office-2010">Office 2010</h3>
<p>This Silverlight-powered site was used to promote Microsoft Office 2010, containing video interviews with people involved in it&rsquo;s development. <a href="http://www.office2010themovie.com/" title="Office 2010 the movie">Office 2010</a></p>
<h3 id="et-online-emmys">ET Online Emmys</h3>
<p>ET Online have used Silverlight to host their page about the Emmy Awards. This is a full site built and run using Silverlight, reminiscent of the flash variant, though much nicer in my opinion.  You have dynamic content, menus, integrated video playback and more. I expect we will see more sites like this going forward as Silverlight gains in popularity with businesses and developers. <a href="http://www.etonline.com/emmys/" title="ET Online Emmys">ET Online Emmys</a></p>
<h3 id="silverlightnet">Silverlight.net</h3>
<p>Of course, you would expect developers to practice what they preach, and Silverlight developers are no exception.  The Official Microsoft Silverlight Site has elements of Silverlight-Powered content littered throughout. It&rsquo;s also a great source of tutorials and information for Silverlight developers. <a href="http://www.silverlight.net/" title="Silverlight.Net">Silverlight.Net</a></p>
<h3 id="toolbox">ToolBox</h3>
<p>This is a nice little tutorial social site aimed at designers. This has a mixture of videos and quizes mixed up in a social achievement system to move you up in ranking from novice to expert. <a href="http://www.microsoft.com/design/toolbox/" title="Toolbox">http://www.microsoft.com/design/toolbox/</a></p>
<h3 id="sharpgis">SharpGIS</h3>
<p>This site has a really cool google-earth style satellite zoom in and out of the world on its title banner.  It would definitely be be nice to see this on a decent internet connection, but alas I haven&rsquo;t got one at my disposal right now.  Still this is a neat idea, and very different from a basic static jpeg. <a href="http://www.sharpgis.net/" title="SharpGIS">www.sharpgis.net</a></p>
<h3 id="and-more">And More</h3>
<p>And the list goes on. Here are a few others I don&rsquo;t have time to go into any detail with.</p>
<ul>
<li>Winter Olympics 2010 - <a href="http://www.sharpgis.net/" title="Winter Olympics 2010">http://www.nbcolympics.com/</a></li>
<li>2009 Presidential Election - <a href="http://weblogs.asp.net/scottgu/archive/2009/01/19/silverlight-and-the-2009-presidential-inauguration.aspx" title="2009 Presidential Elections">http://weblogs.asp.net/scottgu/archive/2009/01/19/silverlight-and-the-2009-presidential-inauguration.aspx</a></li>
<li>Valentino Rossi Fansite - <a href="http://www.valentinorossi.fr/" title="Valentino Rossi">http://www.valentinorossi.fr/</a></li>
<li>Nibbles Tutorials -<a href="http://www.nibblestutorials.net/" title="Nibbles Tutorials"> http://www.nibblestutorials.net/</a></li>
</ul>
<p>I&rsquo;m sure if you look for yourself you will find a lot more. Please add any other interesting ones that you find by posting some comments.</p>
</description>
    </item>
    
  </channel>
</rss>