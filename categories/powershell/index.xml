<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>PowerShell on csMACnz&#39;s Blog</title>
    <link>https://blogmigration.csmac.nz/categories/powershell/</link>
    <description>Recent content in PowerShell on csMACnz&#39;s Blog</description>
    <image>
      <url>https://blogmigration.csmac.nz/favicon.png</url>
      <title>csMACnz&#39;s Blog</title>
      <link>https://blogmigration.csmac.nz</link>
    </image>
    <ttl>1440</ttl>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-nz</language>
    <lastBuildDate>Mon, 09 Jul 2018 06:00:00 +0000</lastBuildDate><atom:link href="https://blogmigration.csmac.nz/categories/powershell/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Some cool tricks with your Windows Shells</title>
      <link>https://blogmigration.csmac.nz/post/some-cool-tricks-with-your-windows-shell/</link>
      <pubDate>Mon, 09 Jul 2018 06:00:00 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/some-cool-tricks-with-your-windows-shell/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been getting more and more back to the command line, doing more with PowerShell and even Bash scripting on Docker and WSL (&lt;a href=&#34;https://docs.microsoft.com/en-us/windows/wsl/install-win10&#34;&gt;Windows Subsystem for Linux&lt;/a&gt;).  There are a few of the tricks I have learned recently that help me every day.&lt;/p&gt;
&lt;h3 id=&#34;f8-searches-history&#34;&gt;F8 searches history!&lt;/h3&gt;
&lt;p&gt;That&amp;rsquo;s right! When you type into the command line (this work in cmd and PowerShell) and then press F8, it will do a back-in-time search for a historical command that begins with what you typed. This is a nice way to auto-complete an entire command with complex arguments quickly and easily.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://res.cloudinary.com/csmacnz/image/upload/v1531122887/F8_Demo_lewuak.gif&#34; alt=&#34;F8 cmd history demo&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;windows-explorer-open-shell-here&#34;&gt;Windows Explorer &amp;ldquo;Open Shell Here&amp;rdquo;&lt;/h3&gt;
&lt;p&gt;This works for WSL, PowerShell, and cmd.  From any folder in Windows Explorer, you can type into the address bar either &lt;code&gt;wsl&lt;/code&gt;, &lt;code&gt;powershell&lt;/code&gt; or &lt;code&gt;cmd&lt;/code&gt; and it will launch the respective shell opened at the same directory.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://res.cloudinary.com/csmacnz/image/upload/v1531123505/ShellOpen_Demo_krpbpz.gif&#34; alt=&#34;Open Shell Here Demo&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;profile&#34;&gt;$PROFILE&lt;/h3&gt;
&lt;p&gt;Powershell has a configuration file that you can add startup scripts to.  This file exists at a path specified by the variable &lt;code&gt;$PROFILE&lt;/code&gt;. You can quickly get to it from PowerShell using &lt;code&gt;notepad++ $PROFILE&lt;/code&gt; (or use whatever text editor appeals).&lt;/p&gt;
&lt;p&gt;You can add all sorts in here, from defining functions to be available, setting environment variables and more.  Some ideas I&amp;rsquo;ve used it for before are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csmac.nz/make-me-a-sandwich/&#34;&gt;Emulating sudo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csmac.nz/aliasing-your-git-status/&#34;&gt;&lt;code&gt;git status&lt;/code&gt; command aliasing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csmac.nz/a-powershell-watch-command/&#34;&gt;Define your own Watch command&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csmac.nz/visual-studio-powershell/&#34;&gt;Load the VS Developer Command Prompt dependencies&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;wsl&#34;&gt;WSL&lt;/h3&gt;
&lt;p&gt;Windows Subsystem for Linux (wsl) is an interesting new development. With this, I can install Ubuntu and have a bash shell I can run Linux commands in. This is what Cygwin always wanted to grow up to be.&lt;/p&gt;
&lt;p&gt;The neat thing is you can pass commands back and forward from Powershell and wsl.&lt;/p&gt;
&lt;p&gt;In powershell, you can type a command such as:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;wsl find . -name *.csproj | % { cat $_ | wsl grep Framework }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This command will execute the command &lt;code&gt;wsl find . -name *.csproj&lt;/code&gt; from the current directory in Linux, pass list of file paths generated back to Powershell, then for each path, execute a &lt;code&gt;grep&lt;/code&gt; search on Linux again. We could now take the collection of results and pipe them once more through PowerShell, or another Linux command for further processing. Clever.&lt;/p&gt;
&lt;p&gt;If you are already a Linux Shell Pro, you will probably find this ability a true PowerUser feature for you.&lt;/p&gt;
&lt;h3 id=&#34;wrap-up&#34;&gt;Wrap up&lt;/h3&gt;
&lt;p&gt;These are just a few of the Shell features I have been loving to use lately. There are so many more cool tips and tricks out there. What are your favourites?&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A PowerShell Watch Command</title>
      <link>https://blogmigration.csmac.nz/post/a-powershell-watch-command/</link>
      <pubDate>Tue, 30 Jan 2018 19:36:30 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/a-powershell-watch-command/</guid>
      <description>&lt;p&gt;I use dotnet-watch a bunch and have used a version via grunt/gulp a little in the past as well.&lt;/p&gt;
&lt;p&gt;In front of me, I had some TypeScript, &lt;code&gt;tsc&lt;/code&gt; and an &lt;code&gt;app.ts&lt;/code&gt; file. I wanted to watch it and trigger &lt;code&gt;tsc&lt;/code&gt; automatically. But there was no csproj, no NuGet, and no npm in sight.&lt;/p&gt;
&lt;p&gt;I went searching far and wide for solutions, and some clever people have some insight to add to the quest:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.reddit.com/r/usefulscripts/comments/4y46kl/powershell_since_theres_no_native_watch_command/&#34;&gt;https://www.reddit.com/r/usefulscripts/comments/4y46kl/powershell_since_theres_no_native_watch_command/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/questions/29066742/watch-file-for-changes-and-run-command-with-powershell&#34;&gt;https://stackoverflow.com/questions/29066742/watch-file-for-changes-and-run-command-with-powershell&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nightroman.wordpress.com/2006/09/26/watch-command-ps1-watch-commands-output-repeatedly/&#34;&gt;https://nightroman.wordpress.com/2006/09/26/watch-command-ps1-watch-commands-output-repeatedly/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;From these, I cobbled together what is now in my &lt;code&gt;Microsoft.PowerShell_profile.ps1&lt;/code&gt; file:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Watch in Powershell
function Invoke-Watch {
    param(
        [string]$Folder,
        [string]$Filter = &amp;quot;*.*&amp;quot;,
        [scriptblock]$Action,
        [Switch]$IncludeSubdirectories = $true
    )
    $watcher = New-Object IO.FileSystemWatcher $folder, $filter -Property @{ 
        IncludeSubdirectories = $IncludeSubdirectories
        EnableRaisingEvents = $true
    }

    Write-Host &amp;quot;Now Watching (ctrl+c to stop)&amp;quot;
    $global:PSWatchFileChanged = $false
    $onChange = Register-ObjectEvent $Watcher Changed -Action {$global:PSWatchFileChanged = $true}
    try{
        
        while($true) {
            &amp;amp; $Action
            while($global:PSWatchFileChanged -eq $false) {
                Start-Sleep -Milliseconds 100
            }
            $global:PSWatchFileChanged = $false
        }
    }
    finally{
        Unregister-Event -SubscriptionId $onChange.Id
    }
}
New-Alias -Name watch -Value Invoke-Watch
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To use it, You pass a few parameters to the script:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Watch tsc compile my ts files
watch -Folder &amp;quot;${PWD}&amp;quot; =Filter &amp;quot;*.ts&amp;quot; -Action { tsc }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;At some point, the parameters will change, and I might make it prettier, or more intuitive. (There is also a nasty global in there, so running more than one at a time is either a feature or a bug, depending on how you use it&amp;hellip;)&lt;/p&gt;
&lt;p&gt;I will probably gist this at some point and keep it up to date with those changes.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Form posts with PowerShell</title>
      <link>https://blogmigration.csmac.nz/post/formpost-with-powershell/</link>
      <pubDate>Mon, 27 Jun 2016 03:57:16 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/formpost-with-powershell/</guid>
      <description>&lt;p&gt;This article is based on an answer found and updated on &lt;a href=&#34;http://stackoverflow.com/a/37729623/2118268&#34;&gt;StackOverflow&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;f you have used PowerShell for much at all, you are probably familiar with &lt;code&gt;Invoke-WebRequest&lt;/code&gt;. But did you know you can carry around a session and have it automatically add and update cookies for you?&lt;/p&gt;
&lt;h3 id=&#34;the-scenario&#34;&gt;The Scenario&lt;/h3&gt;
&lt;p&gt;I had an API I wanted to consume, but it was a private one. That is, It was designed and used for a SPA app to consume. The auth for this API (for the write endpoints anyway) had two requirements: It authorised against cookies and required a csrf token in the requests.  Don&amp;rsquo;t get hung up on the why or who wrote it, but my plan was to call it without having to change it.&lt;/p&gt;
&lt;h3 id=&#34;sessionvariable&#34;&gt;SessionVariable&lt;/h3&gt;
&lt;p&gt;It turns out that the command &lt;code&gt;Invoke-WebRequest&lt;/code&gt; has an argument &lt;code&gt;-SessionVariable&lt;/code&gt; where you can provide an object to store session state.  On subsequent requests, you can pass it along again using the argument &lt;code&gt;-WebSession&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So we know how to store the session, how do we post a form? Well, clearly you get the page with the form on it, then post that form back. If you have a proper classic HTML page with a &lt;code&gt;Form&lt;/code&gt; on it, you can do a &lt;code&gt;GET&lt;/code&gt; to that page and use it by filling it out and executing the provided command.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$myUrl = &amp;quot;http://mydomain.url&amp;quot;  

$response = Invoke-WebRequest -Uri $myUrl -Method GET -SessionVariable mySession

$form = $response.Forms[0]
$form.Fields[&amp;quot;username&amp;quot;] = &amp;quot;username&amp;quot;
$form.Fields[&amp;quot;password&amp;quot;] = &amp;quot;password&amp;quot;

$response = Invoke-WebRequest -Uri ($myUrl + $form.Action) -WebSession $mySession -Method POST 
$response.StatusDescription #should be OK
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You may have to check exactly what format &lt;code&gt;$form.Action&lt;/code&gt; takes to see if it is absolute or relative URL, or if it includes the domain or not.&lt;/p&gt;
&lt;p&gt;Also, check what your form fields are called. I have a mistake in mine where the field was called &lt;code&gt;user&lt;/code&gt; rather than &lt;code&gt;username&lt;/code&gt; on one page.&lt;/p&gt;
&lt;p&gt;Note that in the first request when you use the &lt;code&gt;-SessionVariable&lt;/code&gt; argument, you just provide the name of the variable, and not a variable itself. That is, use &lt;code&gt;mySession&lt;/code&gt; rather than &lt;code&gt;$mySession&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you complete this correctly you should have all the correct cookies passed around. This means that both:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The post will work if there is any cookie verification across the get and post and&lt;/li&gt;
&lt;li&gt;The resulting &lt;code&gt;$mySession&lt;/code&gt; will contain an authenticated cookie for further authenticated requests.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;csrf&#34;&gt;CSRF&lt;/h3&gt;
&lt;p&gt;Part two is that I had to parse out csrf. I am still not sure why the requests require the csrf token, probably because it&amp;rsquo;s a &lt;a href=&#34;samnewman.io/patterns/architectural/bff/&#34;&gt;BFF&lt;/a&gt; API.&lt;/p&gt;
&lt;p&gt;Luckily, the login form had a token in the original form, so I was able to just provide that in subsequent requests.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$payload = @{_csrf = $form.Fields[&amp;quot;_csrf&amp;quot;]; data = &amp;quot;more data&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and then can just use the payload as normal:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$response = Invoke-WebRequest -Uri ($myUrl + $form.Action) -WebSession $mySession -Method POST -Body $payload
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Of course, your mileage may vary. But this worked for me. The other option would have been to parse out the value from the page, from cookies, or actually, just fix the service to not need it I guess?&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Treat Warnings As Errors with this one weird PowerShell Script...</title>
      <link>https://blogmigration.csmac.nz/post/treat-warnings-as-errors-with-this-one-weird-powershell-script/</link>
      <pubDate>Mon, 09 May 2016 08:30:59 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/treat-warnings-as-errors-with-this-one-weird-powershell-script/</guid>
      <description>&lt;p&gt;There is this great feature in Visual Studio that lets you really dial up the quality of your code. It has been there forever it seems, but very few people use it.&lt;/p&gt;
&lt;p&gt;The compiler spits out errors, which stop your app compiling. You fix your errors and move on.  But the compiler also spits out a lot of warnings too. And many of these are to do with the quality of your code, and possible code errors you have introduced that could cause you issues later on.&lt;/p&gt;
&lt;p&gt;Did you know you can get the builds to actually fail to compile from these warnings?&lt;/p&gt;
&lt;h3 id=&#34;treat-warnings-as-errors&#34;&gt;Treat Warnings As Errors&lt;/h3&gt;
&lt;p&gt;If you head to the properties dialog of a project, you will see the following under the Build menu.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://res.cloudinary.com/csmacnz/image/upload/v1462825696/TreatWarningsAsErrors_vzev9g.png&#34; alt=&#34;Visual Studio Build Config Settings&#34;&gt;&lt;/p&gt;
&lt;p&gt;See that radio button? Treat warnings as errors. You wanna set that baby to All. Do it now! While you are in here, set the Warning level to 4 as well.&lt;/p&gt;
&lt;p&gt;That&amp;rsquo;s it! You are all set to start failing your builds, for this project anyway. In fact, go ahead and try to build. There is a better than normal chance that you probably already have some warnings and now have a failing build. Well done.&lt;/p&gt;
&lt;p&gt;Actually, you probably only turned that on for Debug builds, so go repeat those steps after changing the Configuration dropdown to Release. And any others you have where this applies.&lt;/p&gt;
&lt;p&gt;The nice thing about &lt;code&gt;TreatWarningsAsErrors&lt;/code&gt; is that it is in the *.csproj file XML, and is actually an MSBuild command.  This means that it will use the same settings when you build at command line using either devenv or MSBuild tools.  So your CI server will apply this too.&lt;/p&gt;
&lt;p&gt;As well as the &lt;code&gt;TreatWarningsAsErrors&lt;/code&gt; command, there is this &lt;code&gt;WarningLevel&lt;/code&gt;. Just turn it up to &lt;code&gt;4&lt;/code&gt; and move on, it is the option you want, trust me.&lt;/p&gt;
&lt;h3 id=&#34;-one-weird-trick&#34;&gt;&amp;hellip; One weird trick&lt;/h3&gt;
&lt;p&gt;So, I mentioned one weird script right?&lt;/p&gt;
&lt;p&gt;If you have an existing solution with lots of projects, you won&amp;rsquo;t want to turn these all on one by one manually. You also don&amp;rsquo;t want to fuss around making sure that if you or someone else has added a bunch of new projects, that these rules are turned on correctly.&lt;/p&gt;
&lt;p&gt;To solve these issues, I have a PowerShell script that runs over a directory, finds all the *.csproj files, and updates their Debug and Release configurations with &lt;code&gt;TreatWarningsAsErrors&lt;/code&gt; set to &lt;code&gt;true&lt;/code&gt;, and &lt;code&gt;WarningLevel&lt;/code&gt; to `4&#39;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;get-childitem . -include *.csproj -recurse -ErrorAction SilentlyContinue | %{
    $_.FullName
    [xml]$proj = get-content $_.FullName
    $modified = 0
    $proj.Project.PropertyGroup | 
    where-object { $_.Condition -match &#39;Configuration.*Platform.*(Debug|Release)&#39; } | %{
        if (-not $_.TreatWarningsAsErrors) {
            $node = $proj.CreateElement(&#39;TreatWarningsAsErrors&#39;, $proj.Project.NamespaceURI)
            $node.InnerText = &#39;true&#39;
            $node = $_.AppendChild($node)
            $modified = 1
        }
        if ($_.TreatWarningsAsErrors -ne &#39;true&#39;) {
            $_.TreatWarningsAsErrors = &#39;true&#39;
            $modified = 1
        }
        if (-not $_.WarningLevel) {
            $node = $proj.CreateElement(&#39;WarningLevel&#39;, $proj.Project.NamespaceURI)
            $node.InnerText = &amp;quot;4&amp;quot;
            $node = $_.AppendChild($node)
            $modified = 1
        }
        if ($_.WarningLevel -ne &amp;quot;4&amp;quot;) {
            $_.WarningLevel.InnerText = &amp;quot;4&amp;quot;
            $modified = 1
        }
    }
    if ($modified -eq 1) {
        $proj.Save($_.FullName)
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is also up on &lt;a href=&#34;https://gist.github.com/csMACnz/6b736c9109023af4c09f6f0b9405081b&#34;&gt;a gist&lt;/a&gt; if you prefer.&lt;/p&gt;
&lt;p&gt;That is it. Run that in your solution directory and you should be sorted.  Don&amp;rsquo;t forget to fix the compiler errors before checking your changes back in though.&lt;/p&gt;
&lt;h3 id=&#34;caveats&#34;&gt;Caveats&lt;/h3&gt;
&lt;p&gt;There is always one project that disobeys with the strict rules. That&amp;rsquo;s ok, just leave it off and come back and fix the issues when you have a spare few moments. Perhaps in a quiet Friday afternoon, or the day after ship day while you wait for those bug reports to come in. Once the problem is fixed, run the script again and hey presto it will be turned on again.&lt;/p&gt;
&lt;p&gt;There are other ways to filter and ignore specific issues but I will leave that as an exercise for the reader if they really want to go down that path.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Make me a sandwich</title>
      <link>https://blogmigration.csmac.nz/post/make-me-a-sandwich/</link>
      <pubDate>Sun, 11 Oct 2015 15:57:06 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/make-me-a-sandwich/</guid>
      <description>&lt;p&gt;A lesson in powershell.&lt;/p&gt;
&lt;p&gt;I typed this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;&amp;gt; iisreset
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which responded with this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Access denied, you must be an administrator of the remote computer to use this command. Either have your account added to the administrator local group of the remote computer or to the domain administrator global group.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So I typed this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;&amp;gt; sudo iisreset
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I was thinking this:
&lt;a href=&#34;https://xkcd.com/149/&#34;&gt;&lt;img src=&#34;https://imgs.xkcd.com/comics/sandwich.png&#34; alt=&#34;&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But got this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;sudo : The term &#39;sudo&#39; is not recognized as the name of a cmdlet, function,  
script file, or operable program. Check the spelling of the name, or if a    
path was included, verify that the path is correct and try again.            
At line:1 char:1                                                             
+ sudo import-module webadministration                                       
+ ~~~~                                                                       
    + CategoryInfo          : ObjectNotFound: (sudo:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
                                                                             
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So I added to my $PROFILE:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;function invoke-assuperuser { Start-Process powershell -Verb runAs $args }
set-alias sudo invoke-assuperuser
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now I can:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;&amp;gt; sudo iisreset
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And it works (In a new window, via UAC)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://res.cloudinary.com/csmacnz/image/upload/v1444625794/yayanimated_syyjd8.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Aliasing your &#39;git status&#39;</title>
      <link>https://blogmigration.csmac.nz/post/aliasing-your-git-status/</link>
      <pubDate>Sat, 18 Apr 2015 13:26:00 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/aliasing-your-git-status/</guid>
      <description>&lt;p&gt;Anyone else have the bad habit of typing in &lt;code&gt;git statsu&lt;/code&gt; or &lt;code&gt;git stauts&lt;/code&gt;? Or maybe you just end up typing &lt;code&gt;git status&lt;/code&gt; all the time at the command line, and wonder if there was a better way.  Well, there is.&lt;/p&gt;
&lt;h3 id=&#34;aliases&#34;&gt;Aliases&lt;/h3&gt;
&lt;p&gt;Most command-line shells have the concept of aliasing. This means you type one thing, and it represents an alternative way to call another command, maybe with implicit parameters baked in that you use all the time. So for me, I want to type &lt;code&gt;gs&lt;/code&gt; to perform a &lt;code&gt;git status&lt;/code&gt; call.&lt;/p&gt;
&lt;h3 id=&#34;powershell&#34;&gt;PowerShell&lt;/h3&gt;
&lt;p&gt;As a .Net developer, I use PowerShell as my preferred command line shell. This means when it comes to git, &lt;a href=&#34;http://blog.csmac.nz/visual-studio-powershell/&#34;&gt;I have PowerShell set up just so&lt;/a&gt;, and it can give me all these nice indicators around what branch I&amp;rsquo;m on etc.  But when It comes to aliases, PowerShell requires a native command to attach that alias to (of which &lt;code&gt;git status&lt;/code&gt; isn&amp;rsquo;t). It also doesn&amp;rsquo;t allow default arguments when you make these aliases.  But it can be done. The trick is to wrap it in a function:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;function Get-GitStatus { &amp;amp; git status }
New-Alias -Name gs -Value Get-GitStatus
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;First we define a function that represents the command we want to execute (&lt;code&gt;git status&lt;/code&gt; in this case), then we call the New-Alias PowerShell command, and provide a name (&lt;code&gt;gs&lt;/code&gt;) and the defined function as the value. Easy.&lt;/p&gt;
&lt;p&gt;As a convenience, I added these two lines to my &lt;code&gt;Microsoft.PowerShell_profile.ps1&lt;/code&gt; file (you can find this using the &lt;code&gt;$PROFILE&lt;/code&gt; variable in your PowerShell) so that the alias is always available when PowerShell starts.&lt;/p&gt;
&lt;h3 id=&#34;bash&#34;&gt;BASH&lt;/h3&gt;
&lt;p&gt;While Bash is not my primary shell, it is the go-to for most developers using. It is easy to get an alias set up in Bash. All you would need is to run the following command:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;alias gs=&#39;git status&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now whenever you type &lt;code&gt;gs&lt;/code&gt; it will run the &lt;code&gt;git status&lt;/code&gt; command. Again, you could put this in your &lt;a href=&#34;http://tldp.org/LDP/abs/html/sample-bashrc.html&#34;&gt;.bashrc file&lt;/a&gt; (or &lt;a href=&#34;http://stackoverflow.com/questions/6883760/git-for-windows-bashrc-or-equivalent-config-files-for-git-bash-shell&#34;&gt;windows equivalent&lt;/a&gt; to make this available whenever you launch the shell.&lt;/p&gt;
&lt;h3 id=&#34;til&#34;&gt;TIL&lt;/h3&gt;
&lt;p&gt;So I was watching someone else give an introduction to git today, and found out that for some commands in git have built in, well established aliases already. one of these is the &lt;code&gt;status&lt;/code&gt; command, using &lt;code&gt;st&lt;/code&gt;. So if &lt;code&gt;git status&lt;/code&gt; is giving you trouble, maybe just look at using &lt;code&gt;git st&lt;/code&gt; instead. No custom aliasing required. I&amp;rsquo;m still going to keep using my &lt;code&gt;gs&lt;/code&gt; though, its still faster.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Visual Studio PowerShell</title>
      <link>https://blogmigration.csmac.nz/post/visual-studio-powershell/</link>
      <pubDate>Thu, 29 Jan 2015 17:54:54 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/visual-studio-powershell/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been using psake as my build tool and running my builds on Appveyor.  Now Appveyor runs with all the visual studio commands available on the path.  When you install visual studio, It gives you a special cmd shell shortcut that loads you an environment with all the visual studio stuff available, which is cool. But not for PowerShell.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DISCLAIMER&lt;/strong&gt;:  I originally found this solution on this &lt;a href=&#34;http://blogs.msdn.com/b/domgreen/archive/2009/05/03/visual-studio-command-prompt-via-powershell.aspx&#34;&gt;msdn blog&lt;/a&gt;, but tweaked it to work with Visual Studio 2013, and 64bit versions of windows.  Since I kept changing machines and loosing my scripts I decided to blog about it so I knew where to look to find the code again.&lt;/p&gt;
&lt;p&gt;With that out of the way, here is the code I add to my PowerShell $PROFILE:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;#### Functions Used to Load VS Command Prompt #####
 
function Get-Batchfile ($file) {
    $cmd = &amp;quot;`&amp;quot;$file`&amp;quot; &amp;amp; set&amp;quot;
    cmd /c $cmd | Foreach-Object {
        $p, $v = $_.split(&#39;=&#39;)
        Set-Item -path env:$p -value $v
    }
}
 
function VisualStudioVars()
{
    $version = &amp;quot;12.0&amp;quot;
    $key = &amp;quot;HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio\&amp;quot; + $version
    $VsKey = Get-ItemProperty $key
    $VsInstallPath = [System.IO.Path]::GetDirectoryName($VsKey.InstallDir)
    $VsInstallDir = [System.IO.Path]::GetDirectoryName($VsInstallPath)
    $VsToolsDir = [System.IO.Path]::Combine($VsInstallDir, &amp;quot;Tools&amp;quot;)
    $vs120comntools = (Get-ChildItem env:VS120COMNTOOLS).Value    
    $batchFile = [System.IO.Path]::Combine($vs120comntools, &amp;quot;vsvars32.bat&amp;quot;)
    Get-Batchfile $batchFile
}
 
###### Run at startup ######
VisualStudioVars
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This basically finds the cmd file vsvars32.bat for visual studio 2013(VS12.0) and loads the specified files to the environment path for this session. Now I have access to devenv.exe and other visual studio tools from PowerShell.  For new versions of Visual Studio, just update the version number references and you&amp;rsquo;re golden.  Note that if you are using a 32bit version of windows, remove the &lt;code&gt;Wow6432Node&lt;/code&gt; from the key path, making it:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$key = &amp;quot;HKLM:SOFTWARE\Microsoft\VisualStudio\&amp;quot; + $version
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Bonus content:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;$env:path += &amp;quot;;&amp;quot; + (Get-Item &amp;quot;Env:ProgramFiles&amp;quot;).Value + &amp;quot;\Git\bin&amp;quot;
$env:path += &amp;quot;;&amp;quot; + (Get-Item &amp;quot;Env:ProgramFiles&amp;quot;).Value + &amp;quot;\nodejs&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is a quick addition of git and node to my PowerShell so I can run these as well.  Extend these as needed for other installed executables.&lt;/p&gt;
&lt;p&gt;When setting up a new machine I also install ps-get and posh-git based on &lt;a href=&#34;http://haacked.com/archive/2011/12/13/better-git-with-powershell.aspx/&#34;&gt;Phil Haack&amp;rsquo;s blog post&lt;/a&gt;.  Check it out for the full instructions of what you need to do, but for my own reference and your second, third and twentieth time, use the following commands&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;# Set the execution policy to allow random scripts from the web
Set-ExecutionPolicy RemoteSigned
# install ps-get
(new-object Net.WebClient).DownloadString(&amp;quot;http://psget.net/GetPsGet.ps1&amp;quot;) | iex
# install posh-git
install-module posh-git
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And that&amp;rsquo;s my PowerShell $PROFLE information. Hope this helps someone other than just me next time I set up a new development machine, or reinstall Windows.&lt;/p&gt;
&lt;h4 id=&#34;2015-05-12-update&#34;&gt;2015-05-12 Update:&lt;/h4&gt;
&lt;p&gt;I use chocolatey to install other helpful components to my shell.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;iex ((new-object net.webclient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Some common tools I like to have installed are:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;choco install -y paint.net
choco install -y autohotkey
choco install -y git
choco install -y gitpad
choco install -y gitextensions
choco install -y nuget.CommandLine
choco install -y github
choco install -y atom
choco install -y colorcop
choco install -y console2
choco install -y f.lux
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>