<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>csMACnz&#39;s Blog</title>
    <link>https://blogmigration.csmac.nz/</link>
    <description>Recent content on csMACnz&#39;s Blog</description>
    <image>
      <url>https://blogmigration.csmac.nz/favicon.png</url>
      <title>csMACnz&#39;s Blog</title>
      <link>https://blogmigration.csmac.nz</link>
    </image>
    <ttl>1440</ttl>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-nz</language>
    <lastBuildDate>Tue, 13 Jul 2021 19:18:43 +0000</lastBuildDate><atom:link href="https://blogmigration.csmac.nz/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Categories</title>
      <link>https://blogmigration.csmac.nz/categories/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/categories/</guid>
      <description></description>
    </item>
    
    <item>
      <title>csMACnz&#39;s Blog</title>
      <link>https://blogmigration.csmac.nz/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Failed to query available provider packages - Terraform NewRelic Provider :facepalm:</title>
      <link>https://blogmigration.csmac.nz/post/terraform-newrelic-provider-facepalm/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/terraform-newrelic-provider-facepalm/</guid>
      <description>&lt;p&gt;Recently I tried upgrading from Terraform 0.12 to 1.0.1. I think the key here is leaving 0.12.&lt;/p&gt;
&lt;p&gt;Anyway, there was a breaking change in 0.13 around how providers worked, and we got this cryptic error.&lt;/p&gt;
&lt;p&gt;(Caveat: I don&amp;rsquo;t actually know how much of this has to do with a newrelic provider update as well or instead, but was what we got the week of 2021/07/12.)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;Initializing provider plugins...
- Reusing previous version of newrelic/newrelic from the dependency lock file
- Finding latest version of hashicorp/newrelic...
- Using previously-installed newrelic/newrelic v2.23.0
‚ï∑
‚îÇ Error: Failed to query available provider packages
‚îÇ
‚îÇ Could not retrieve the list of available versions for provider hashicorp/newrelic: provider registry registry.terraform.io does not have a provider 
‚îÇ named registry.terraform.io/hashicorp/newrelic
‚îÇ
‚îÇ Did you intend to use newrelic/newrelic? If so, you must specify that source address in each module which requires that provider. To see which      
‚îÇ modules are currently depending on hashicorp/newrelic, run the following command:
‚îÇ     terraform providers
|
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So I&amp;rsquo;d already added this at my root module but this error still occurred.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-hcl&#34;&gt;terraform {
  required_providers {
    newrelic = {
      source  = &amp;quot;newrelic/newrelic&amp;quot;
      version = &amp;quot;2.23.0&amp;quot;
    }
  }
}

provider &amp;quot;newrelic&amp;quot; {
  api_key    = &amp;quot;12345&amp;quot;
  account_id = &amp;quot;12345&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It took a while to find the right docs to understand this one.&lt;/p&gt;
&lt;p&gt;The key message from above is the &lt;code&gt;You must specify that source address in each module which requires that provider.&lt;/code&gt; message. We are using modules, and the breaking change to 0.13 and above is that modules can specify &lt;code&gt;required_providers&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;What they don&amp;rsquo;t tell you clearly, is that when trying to resolve &amp;ldquo;newrelic&amp;rdquo; provider by default, it will look for &amp;ldquo;hashicorp/newrelic&amp;rdquo;. However the actual provider source is &amp;ldquo;newrelic/newrelic&amp;rdquo;. So to make this work the optional &lt;code&gt;required_providers&lt;/code&gt; is actually mandatory, and actually needs the &lt;code&gt;source  = &amp;quot;newrelic/newrelic&amp;quot;&lt;/code&gt; property.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-hcl&#34;&gt;terraform {
  required_providers {
    newrelic = {
      source = &amp;quot;newrelic/newrelic&amp;quot;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Adding this to every module that uses newrelic solved the problem.&lt;/p&gt;
&lt;p&gt;If you are doing this, you might also need to migrate your state over as well. Do this after running &lt;code&gt;terraform init&lt;/code&gt; from inside your config folder. This migrates the data in your state file to correctly map to the new provider.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;terraform state replace-provider newrelic newrelic/newrelic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;More details here: &lt;a href=&#34;https://www.terraform.io/docs/cli/commands/state/replace-provider.html&#34;&gt;https://www.terraform.io/docs/cli/commands/state/replace-provider.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If you do migrate 0.12 to 0.13 first, instead of stupidly jumping straight to 1.0.1, you can follow a more useful migration guide and the &lt;code&gt;0.13upgrade&lt;/code&gt; command instead. ü§¶‚Äç‚ôÇÔ∏è&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.terraform.io/docs/cli/commands/0.13upgrade.html&#34;&gt;https://www.terraform.io/docs/cli/commands/0.13upgrade.html&lt;/a&gt;
&lt;a href=&#34;https://www.terraform.io/upgrade-guides/0-13.html&#34;&gt;https://www.terraform.io/upgrade-guides/0-13.html&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Posts</title>
      <link>https://blogmigration.csmac.nz/post/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Tags</title>
      <link>https://blogmigration.csmac.nz/tags/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/tags/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Terraform</title>
      <link>https://blogmigration.csmac.nz/tags/terraform/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/tags/terraform/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Terraform</title>
      <link>https://blogmigration.csmac.nz/categories/terraform/</link>
      <pubDate>Tue, 13 Jul 2021 19:18:43 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/categories/terraform/</guid>
      <description></description>
    </item>
    
    <item>
      <title>kotlin</title>
      <link>https://blogmigration.csmac.nz/tags/kotlin/</link>
      <pubDate>Tue, 11 May 2021 17:42:06 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/tags/kotlin/</guid>
      <description></description>
    </item>
    
    <item>
      <title>kotlin</title>
      <link>https://blogmigration.csmac.nz/categories/kotlin/</link>
      <pubDate>Tue, 11 May 2021 17:42:06 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/categories/kotlin/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Kotlin, TeamCity and reflection</title>
      <link>https://blogmigration.csmac.nz/post/kotlin-teamcity-and-reflection/</link>
      <pubDate>Tue, 11 May 2021 17:42:06 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/kotlin-teamcity-and-reflection/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been getting stuck into upskilling in Kotlin. Mostly for TeamCity build automation and trying to produce quality tested code in a space where automation was retrofitted in.&lt;/p&gt;
&lt;p&gt;Today&amp;rsquo;s fun little problem was the error message:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Runtime error RootProjectId: kotlin.reflect.jvm.internal.impl.builtins.KotlinBuiltIns$3[92]: java.lang.AssertionError: Built-in class kotlin.Any is not found&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The canonical stack overflow question that (at the time of writing this) had no answer: &lt;a href=&#34;https://stackoverflow.com/questions/67199546/why-am-i-getting-java-lang-assertionerror-built-in-class-kotlin-any-is-not-fou&#34;&gt;https://stackoverflow.com/questions/67199546/why-am-i-getting-java-lang-assertionerror-built-in-class-kotlin-any-is-not-fou&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The repro was the simplest piece of code in the end. I was even able to point it at a teamcity class over my own (&lt;code&gt;Project&lt;/code&gt;):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import kotlin.reflect.full.declaredMemberProperties

val props = Project::class.declaredMemberProperties
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(For reference, i tried a few version configurations, but they were mainly kotlin version 1.3.31 teamcity version 2019.2 and kotlin version 1.4.31 and teamcity version 202.2.2)&lt;/p&gt;
&lt;p&gt;At this point in time and with some further testing, I&amp;rsquo;ve come to the conclusion that &lt;strong&gt;reflection just isn&amp;rsquo;t supported on teamcity with Kotlin&lt;/strong&gt;. I&amp;rsquo;ve found one or two Issue links to back that up too: &lt;a href=&#34;https://youtrack.jetbrains.com/issue/TW-59901&#34;&gt;https://youtrack.jetbrains.com/issue/TW-59901&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(¬¨_¬¨ )&lt;/p&gt;
&lt;p&gt;If anyone else managed to find a solution that works, or if any future version adds the missing puzzle pieces that make this work, I would be greatful to hear.&lt;/p&gt;
&lt;p&gt;For now, I have replaced the reflection with good ol&#39; verbose fragile code.&lt;/p&gt;
&lt;p&gt;Luckily, the tests allow reflection no problem so at least the fragility of this case is covered. If someone adds a property then at least a test fails until the verbose code had been amended.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>software development</title>
      <link>https://blogmigration.csmac.nz/tags/software-development/</link>
      <pubDate>Tue, 11 May 2021 17:42:06 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/tags/software-development/</guid>
      <description></description>
    </item>
    
    <item>
      <title>software development</title>
      <link>https://blogmigration.csmac.nz/categories/software-development/</link>
      <pubDate>Tue, 11 May 2021 17:42:06 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/categories/software-development/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Bluetooth Devices keep disconnecting</title>
      <link>https://blogmigration.csmac.nz/post/bluetooth-devices-keep-disconnecting/</link>
      <pubDate>Mon, 09 Nov 2020 07:11:07 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/post/bluetooth-devices-keep-disconnecting/</guid>
      <description>&lt;p&gt;It all started when I installed Windows Update 20H2 in October 2020.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve had a stable machine (HP ZBook laptop for reference) for months and months with the same Bluetooth hardware, no issues. But that fateful day I installed the 20H2 update from Microsoft, everything changed.&lt;/p&gt;
&lt;p&gt;Suddenly I was having disconnect issues. I have a Bluetooth keyboard and Bluetooth mouse connected (I think they are both low energy?) And I found that one of them would reconnect, and the other wouldn&amp;rsquo;t. If I turned one-off, the other would reconnect, but the first one wouldn&amp;rsquo;t be able to when turned back on.&lt;/p&gt;
&lt;p&gt;As a temporary fix, I was able to connect the first device, then delete and re-add the second device. After somewhere between 10 minutes and half an hour, one device would disconnect again.&lt;/p&gt;
&lt;p&gt;I tried all the solutions from googling this issue, but the only one that worked was to update the Intel Bluetooth drivers.&lt;/p&gt;
&lt;p&gt;In Device Manager on Windows, under Bluetooth, the device is listed as &amp;ldquo;Intel(R) Wireless Bluetooth(R) and no amount of Windows Update to resolve new drivers helped.  But then I found the official driver support from intel: &lt;a href=&#34;https://www.intel.com/content/www/us/en/support/intel-driver-support-assistant.html&#34;&gt;Intel Driver Support Assistant&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I installed the tool and let it run. Lucky for me, there was a newer Bluetooth Driver for Windows 10 that I could download and install (amongst a few other Intel drivers as well).&lt;/p&gt;
&lt;p&gt;After installing the latest intel Bluetooth driver, I haven&amp;rsquo;t noticed any other issues since. It is back to business as usual now.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>C Sharp</title>
      <link>https://blogmigration.csmac.nz/tags/c-sharp/</link>
      <pubDate>Sun, 26 Jul 2020 02:00:00 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/tags/c-sharp/</guid>
      <description></description>
    </item>
    
    <item>
      <title>C Sharp</title>
      <link>https://blogmigration.csmac.nz/categories/c-sharp/</link>
      <pubDate>Sun, 26 Jul 2020 02:00:00 +0000</pubDate>
      
      <guid>https://blogmigration.csmac.nz/categories/c-sharp/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>