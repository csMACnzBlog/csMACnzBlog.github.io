<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>There can be only one return; 0 RLY? - csMacnz&#39;s Blog</title><link rel="apple-touch-icon" href="https://csmacnzblog.github.io/images/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="https://csmacnzblog.github.io/images/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="https://csmacnzblog.github.io/images/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="https://csmacnzblog.github.io/images/favicons/manifest.json">
<link rel="icon" href="https://csmacnzblog.github.io/images/favicons/favicon.ico">
<meta name="keywords" content="" />
<meta name="description" content="" /><meta itemprop="name" content="There can be only one return; 0 RLY?">
<meta itemprop="description" content="My opinions and choices on style of coding evolves and changes over time. By blogging about this now, I can refer back later when I change my mind. I can also elicit the opinions of others to influence me to change my ways if I happen to be wrong and not know it yet.
Lets talk about returns. There is an opinion that methods should only have a single return. This gives them a precise flow of control, and forces you to essentially either process data through a few processes and return the final result (which can be very functional) or store a result variable and correctly populate it within control flow logic (&lsquo;if&rsquo;/&lsquo;else&rsquo;, &lsquo;switch&rsquo;, &lsquo;while&rsquo; commands, for instance)."><meta itemprop="datePublished" content="2017-12-03T22:15:55+00:00" />
<meta itemprop="dateModified" content="2017-12-03T22:15:55+00:00" />
<meta itemprop="wordCount" content="1558">
<meta itemprop="keywords" content="Tips and Tricks,c#," /><meta property="og:title" content="There can be only one return; 0 RLY?" />
<meta property="og:description" content="My opinions and choices on style of coding evolves and changes over time. By blogging about this now, I can refer back later when I change my mind. I can also elicit the opinions of others to influence me to change my ways if I happen to be wrong and not know it yet.
Lets talk about returns. There is an opinion that methods should only have a single return. This gives them a precise flow of control, and forces you to essentially either process data through a few processes and return the final result (which can be very functional) or store a result variable and correctly populate it within control flow logic (&lsquo;if&rsquo;/&lsquo;else&rsquo;, &lsquo;switch&rsquo;, &lsquo;while&rsquo; commands, for instance)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://csmacnzblog.github.io/post/there-can-be-only-one-return/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-12-03T22:15:55+00:00" />
<meta property="article:modified_time" content="2017-12-03T22:15:55+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="There can be only one return; 0 RLY?"/>
<meta name="twitter:description" content="My opinions and choices on style of coding evolves and changes over time. By blogging about this now, I can refer back later when I change my mind. I can also elicit the opinions of others to influence me to change my ways if I happen to be wrong and not know it yet.
Lets talk about returns. There is an opinion that methods should only have a single return. This gives them a precise flow of control, and forces you to essentially either process data through a few processes and return the final result (which can be very functional) or store a result variable and correctly populate it within control flow logic (&lsquo;if&rsquo;/&lsquo;else&rsquo;, &lsquo;switch&rsquo;, &lsquo;while&rsquo; commands, for instance)."/>
<link rel=stylesheet href="https://csmacnzblog.github.io/css/bundle.min.ce383e7297312216c2d2ced30574d5a9ae83c451db9f064a454509955ae2462d.css" integrity="sha256-zjg&#43;cpcxIhbC0s7TBXTVqa6DxFHbnwZKRUUJlVriRi0=" crossorigin="anonymous"><script src="https://csmacnzblog.github.io/js/bundle.min.ad6d83537f5b4374c837a12a76422496582e04d1dde91bbb443641ec12c506c6.js" integrity="sha256-rW2DU39bQ3TIN6EqdkIkllguBNHd6Ru7RDZB7BLFBsY=" crossorigin="anonymous"></script>
</head><body><header><nav class="navbar navbar-expand-xl fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://csmacnzblog.github.io">
      <img class="logo" alt="Logo" src="https://csmacnzblog.github.io/images/logo.webp" loading="lazy"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-1 mb-2 mb-lg-0"><form class="search-bar d-flex ms-1" action="https://csmacnzblog.github.io/search">
  <div class="input-group input-group-sm">
    <button class="btn btn-search disabled position-absolute left-0" type="submit"><i class="fas fa-fw fa-search"></i></button>
    <input class="form-control rounded-pill" id="searchQuery" name="q" type="search" aria-label="Search">
  </div>
</form></ul><ul class="navbar-nav me-1 mb-2 mb-lg-0 me-1 ms-auto"><li class="nav-item">
  <a class="nav-link" data-bs-toggle="offcanvas" href="#offcanvasSettings" role="button"
    aria-controls="offcanvasSettings">
    <i class="fas fa-fw fa-sliders-h"></i> Settings
  </a>
</li>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings"
  aria-labelledby="offcanvasSettingsLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" w id="offcanvasSettingsLabel"><i class="fas fa-fw fa-sliders-h"></i> Settings</h5>
    <a role="button" data-bs-dismiss="offcanvas" aria-label="Close">
      <span class="fas fa-2x fa-fw fa-times"></span>
    </a>
  </div>
  <div class="offcanvas-body"><section class="setting">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-adjust"></i> Mode</label>
    </div>
    <div class="col-auto ms-auto">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="modeSwitcher">
      </div>
    </div>
  </form>
</section>
<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <span id="btnPalette" class="btn btn-sm"><i class="fas fa-eye-dropper"></i></span>
    </div>
  </form>
  <div class="container mt-2 visually-hidden" id="palettePicker">
    <div class="btn-group"><button type="button" id="palette-blue" title="Blue" 
          class="btn btn-sm palette bg-blue d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-blue-gray" title="Blue Gray" 
          class="btn btn-sm palette bg-blue-gray d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-brown" title="Brown" 
          class="btn btn-sm palette bg-brown d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-cyan" title="Cyan" 
          class="btn btn-sm palette bg-cyan d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-green" title="Green" 
          class="btn btn-sm palette bg-green d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-indigo" title="Indigo" 
          class="btn btn-sm palette bg-indigo d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-orange" title="Orange" 
          class="btn btn-sm palette bg-orange d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-pink" title="Pink" 
          class="btn btn-sm palette bg-pink d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-purple" title="Purple" 
          class="btn btn-sm palette bg-purple d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-red" title="Red" 
          class="btn btn-sm palette bg-red d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-teal" title="Teal" 
          class="btn btn-sm palette bg-teal d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-yellow" title="Yellow" 
          class="btn btn-sm palette bg-yellow d-flex align-items-center justify-content-center">
        </button></button>
    </div>
  </div>
</section></div>
</div></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row" aria-label="breadcrumb">
  <ol class="breadcrumb surface"><li class="breadcrumb-item"><a href="https://csmacnzblog.github.io/">Home</a></li><li class="breadcrumb-item"><a href="https://csmacnzblog.github.io/post/">Posts</a></li><li class="breadcrumb-item active">There can be only one return; 0 RLY?</li></ol>
</nav><article class="post row surface"><div class="post-toolbox">
  <div class="col-12 d-none d-lg-block">
    <a id="sidebarToggler" class="fas fa-fw fa-2x fa-expand-alt" role="button"></a>
  </div>
</div>
<h1 class="post-title my-3">There can be only one return; 0 RLY?</h1><div class="post-meta mb-3">
  <span class="post-date me-2">
    <i class="fas fa-fw fa-calendar-alt"></i>Dec 3, 2017
  </span>
  <span class="post-reading-time me-2">
    <i class="fas fa-fw fa-coffee"></i>8 min read
  </span>
<a href="https://csmacnzblog.github.io/categories/tips-and-tricks/" class="post-taxonomy">#Tips and Tricks</a><a href="https://csmacnzblog.github.io/categories/c#/" class="post-taxonomy">#c#</a><a href="https://csmacnzblog.github.io/tags/tips-and-tricks/" class="post-taxonomy">#Tips and Tricks</a><a href="https://csmacnzblog.github.io/tags/c#/" class="post-taxonomy">#c#</a></div>
<a id="btnTOC" class="fas fa-fw fa-2x fa-list-alt position-fixed" data-bs-toggle="offcanvas" href="#offcanvasTOC" aria-controls="offcanvasTOC" role="button">
</a>

<div class="offcanvas offcanvas-end surface" tabindex="-1" id="offcanvasTOC" aria-labelledby="offcanvasTOCLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasTOCLabel">Table Of Contents</h5>
    <a role="button" data-bs-dismiss="offcanvas" aria-label="Close">
      <span class="fas fa-2x fa-fw fa-times"></span>
    </a>
  </div>
  <div class="offcanvas-body">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#wheniusearesultvar">WhenIUseAResultVar</a></li>
        <li><a href="#breaking-example-three">Breaking Example Three</a></li>
        <li><a href="#why-i-break-my-own-rules">Why I break my own rules.</a></li>
        <li><a href="#when-there-isnt-any-return-value">When there isn&rsquo;t any return value</a></li>
        <li><a href="#exceptions">Exceptions</a></li>
        <li><a href="#an-extra-section-about-short-circuiting">An extra section about short circuiting</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div><div class="post-content mb-3"><p>My opinions and choices on style of coding evolves and changes over time. By blogging about this now, I can refer back later when I change my mind. I can also elicit the opinions of others to influence me to change my ways if I happen to be wrong and not know it yet.</p>
<p>Lets talk about returns.  There is an opinion that methods should only have a single return. This gives them a precise flow of control, and forces you to essentially either process data through a few processes and return the final result (which can be very functional) or store a result variable and correctly populate it within control flow logic (&lsquo;if&rsquo;/&lsquo;else&rsquo;, &lsquo;switch&rsquo;, &lsquo;while&rsquo; commands, for instance). If you don&rsquo;t actually return a result, you can still think about flow of control and where you exit from.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIPipeDataIntoOtherFunctions(<span style="color:#66d9ef">string</span> fileName)
{
    <span style="color:#66d9ef">var</span> input1 = Loader.LoadInput();
    
    <span style="color:#66d9ef">var</span> input2 = FileStore.ReadAllContent(fileName);
    
    <span style="color:#66d9ef">return</span> WhenIUseAResultVar(input1, input2);
}

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIUseAResultVar(<span style="color:#66d9ef">int</span> input1, <span style="color:#66d9ef">string</span> input2)
{
    <span style="color:#66d9ef">string</span> result;
    
    <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">5</span>)
    {
        <span style="color:#66d9ef">var</span> part1 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>(<span style="color:#e6db74">&#39;a&#39;</span>, input1);
        result = part1 + <span style="color:#e6db74">&#34; &#34;</span> + input2;
    }
    <span style="color:#66d9ef">else</span>
    {
        result = <span style="color:#66d9ef">null</span>;
    }
    
    <span style="color:#66d9ef">return</span> result;
}

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff(<span style="color:#66d9ef">string</span> foo, <span style="color:#66d9ef">int</span> bar)
{
    <span style="color:#66d9ef">if</span> (bar &gt; <span style="color:#ae81ff">10</span>)
    {
        <span style="color:#66d9ef">var</span> something = WhenIUseAResultVar(bar, foo);
        OutputGuy.Take(something);
    }
    <span style="color:#66d9ef">else</span>
    {
        <span style="color:#66d9ef">var</span> somethingElse = WhenIPipeDataIntoOtherFunctions();
        Printer.Print(somethingElse);
    }
}
</code></pre></div><p>The first one seems self explainatory, but I will come back to that one soon. Lets discuss &lsquo;WhenIUseAResultVar&rsquo;.</p>
<h3 id="wheniusearesultvar">WhenIUseAResultVar</h3>
<p>I have a method with a very awkward control flow. But here is the catch: This control flow actually is enforced (in C#) by the compiler that result must be initialised.</p>
<p>My method could decalare at the start that &lsquo;result&rsquo; is initialised to &lsquo;null&rsquo;, telling me that a null could be returned if all logic falls through. In this case I have gone for the opposite, which means the compile ensures that all my cases through my control flow logic will set the value of result. for building and modifying this kind of method is like a free unit test.</p>
<p>For example, lets modify it as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs">
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIUseAResultVar(<span style="color:#66d9ef">int</span> input1, <span style="color:#66d9ef">string</span> input2)
{
    <span style="color:#66d9ef">string</span> result;
    
    <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">5</span>)
    {
        <span style="color:#66d9ef">var</span> part1 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>(<span style="color:#e6db74">&#39;a&#39;</span>, input1);
        <span style="color:#66d9ef">if</span> (input2 == <span style="color:#e6db74">&#34;Business&#34;</span>)
        {
            result = part1 + <span style="color:#e6db74">&#34; &#34;</span> + input2;
        }
    }
    <span style="color:#66d9ef">else</span>
    {
        result = <span style="color:#66d9ef">null</span>;
    }
    
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>This code actually will not compile. It has compiler error <code>CS0165</code> <code>Use of unassigned local variable 'result</code>.</p>
<p><img class="img-fluid" src="http://res.cloudinary.com/csmacnz/image/upload/v1510945400/ControlFlowFail_kfkzq1.png" alt="Use of unassigned local variable &amp;lsquo;result"  loading="lazy" />
</p>
<p>For me, this is gold.</p>
<h3 id="breaking-example-three">Breaking Example Three</h3>
<p>To explain later why I like doing this, even when there is no return value, lets look at an alternative way to write &lsquo;DoStuff&rsquo;:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff(<span style="color:#66d9ef">string</span> foo, <span style="color:#66d9ef">int</span> bar)
{
    <span style="color:#66d9ef">if</span>(bar &gt; <span style="color:#ae81ff">10</span>)
    {
        <span style="color:#66d9ef">var</span> something = WhenIUseAResultVar(bar, foo);
        OutputGuy.Take(something);
        <span style="color:#66d9ef">return</span>;
    }
    
    <span style="color:#66d9ef">var</span> somethingElse = WhenIPipeDataIntoOtherFunctions();
    Printer.Print(somethingElse);
}
</code></pre></div><p>It might look better to you for now, but stick with me. I will refer back to this in a moment.</p>
<h3 id="why-i-break-my-own-rules">Why I break my own rules.</h3>
<p>I don&rsquo;t usually break this rule. But when I do, I do so strictly and with intent.</p>
<p>Preconditions and validations.</p>
<p>There is a time and a place to exit early, and it is preconditions and validations. throwing <code>OutOfRangeException</code> <code>ArgumentNullException</code> <code>ArgumentException</code> and other preconditions make sense to exit early.</p>
<p>To prove this, Lets try to strictly applying my &lsquo;laws&rsquo; to a slightly more detailed version of the <code>WhenIUseAResultVar</code> method:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIUseAResultVar(<span style="color:#66d9ef">int</span> input1, <span style="color:#66d9ef">string</span> input2)
{
    <span style="color:#66d9ef">string</span> result;
    <span style="color:#66d9ef">if</span> (input1 &lt;= <span style="color:#ae81ff">0</span>)
    {
        <span style="color:#75715e">// Technically, this is already an early return.
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IndexOutOfRangeException();
    }
    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2))
    {
        <span style="color:#75715e">// Technically, this is already an early return.
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IndexOutOfRangeException();
    }
    
    <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">100</span>)
    {
        <span style="color:#66d9ef">string</span> result = <span style="color:#e6db74">&#34;Case 1 Result&#34;</span>;
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">5</span>)
    {
        <span style="color:#66d9ef">var</span> part1 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>(<span style="color:#e6db74">&#39;a&#39;</span>, input1);
        result = part1 + <span style="color:#e6db74">&#34; &#34;</span> + input2;
    }
    <span style="color:#66d9ef">else</span>
    {
        result = <span style="color:#e6db74">&#34;Some Fallback Result&#34;</span>;
    }
    
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>Hmmm&hellip; turns out this is a poor example and I can&rsquo;t actually acheive it with exceptions. For arguments sake, lets use &lsquo;null&rsquo; as failed, rather than throwing.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIUseAResultVar(<span style="color:#66d9ef">int</span> input1, <span style="color:#66d9ef">string</span> input2)
{
    <span style="color:#66d9ef">string</span> result;
    <span style="color:#66d9ef">if</span> (input1 &lt;= <span style="color:#ae81ff">0</span>)
    {
        result = <span style="color:#66d9ef">null</span>;
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2))
    {
        result = <span style="color:#66d9ef">null</span>;
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">100</span>)
    {
        <span style="color:#66d9ef">string</span> result = <span style="color:#e6db74">&#34;Case 1 Result&#34;</span>;
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">5</span>)
    {
        <span style="color:#66d9ef">var</span> part1 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>(<span style="color:#e6db74">&#39;a&#39;</span>, input1);
        result = part1 + <span style="color:#e6db74">&#34; &#34;</span> + input2;
    }
    <span style="color:#66d9ef">else</span>
    {
        result = <span style="color:#e6db74">&#34;Some Fallback Result&#34;</span>;
    }
    
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>I can already feel the pain of this.  What I would actually do:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIUseAResultVar(<span style="color:#66d9ef">int</span> input1, <span style="color:#66d9ef">string</span> input2)
{
    <span style="color:#66d9ef">if</span> (input1 &lt;= <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2)) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
    
    <span style="color:#66d9ef">string</span> result;
    
    <span style="color:#66d9ef">if</span> (input2 &gt; <span style="color:#ae81ff">100</span>)
    {
        <span style="color:#66d9ef">string</span> result = <span style="color:#e6db74">&#34;Case 1 Result&#34;</span>;
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">5</span>)
    {
        <span style="color:#66d9ef">var</span> part1 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>(<span style="color:#e6db74">&#39;a&#39;</span>, input1);
        result = part1 + <span style="color:#e6db74">&#34; &#34;</span> + input2;
    }
    <span style="color:#66d9ef">else</span>
    {
        result = <span style="color:#e6db74">&#34;Some Fallback Result&#34;</span>;
    }
    
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>I may even use the single line format above without the braces on my returns, to further distinguish them for critical method logic.</p>
<h3 id="when-there-isnt-any-return-value">When there isn&rsquo;t any return value</h3>
<p>Even when you have a &lsquo;void&rsquo; method, the method still returns.</p>
<p>Remember <code>DoSomething</code> from above? Let&rsquo;s do something similar to above and strictly apply a single point of return (i.e. the end of the method).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff(<span style="color:#66d9ef">string</span> foo, <span style="color:#66d9ef">int</span> bar)
{
    <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">0</span> &amp;&amp;!<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2) &amp;&amp; input2 &lt; <span style="color:#ae81ff">100</span>)
    {
        <span style="color:#66d9ef">if</span> (bar &gt; <span style="color:#ae81ff">10</span>)
        {
            <span style="color:#66d9ef">var</span> something = WhenIUseAResultVar(bar, foo);
            OutputGuy.Take(something);
        }
        <span style="color:#66d9ef">else</span>
        {
            <span style="color:#66d9ef">var</span> somethingElse = WhenIPipeDataIntoOtherFunctions();
            Printer.Print(somethingElse);
        }
    }
}
</code></pre></div><p>Or</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff(<span style="color:#66d9ef">string</span> foo, <span style="color:#66d9ef">int</span> bar)
{
    <span style="color:#66d9ef">if</span> (input1 &gt; <span style="color:#ae81ff">0</span>)
    {
        <span style="color:#66d9ef">if</span> (!<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2))
        {
            <span style="color:#66d9ef">if</span> (input2 &lt; <span style="color:#ae81ff">100</span>)
            {
                <span style="color:#66d9ef">if</span> (bar &gt; <span style="color:#ae81ff">10</span>)
                {
                    <span style="color:#66d9ef">var</span> something = WhenIUseAResultVar(bar, foo);
                    OutputGuy.Take(something);
                }
                <span style="color:#66d9ef">else</span>
                {
                    <span style="color:#66d9ef">var</span> somethingElse = WhenIPipeDataIntoOtherFunctions();
                    Printer.Print(somethingElse);
                }
            }
        }
    }
}
</code></pre></div><p>Or</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff(<span style="color:#66d9ef">string</span> foo, <span style="color:#66d9ef">int</span> bar)
{
    <span style="color:#66d9ef">if</span> (input1 &lt;= <span style="color:#ae81ff">0</span>)
    {
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2))
    {
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (input2 &gt; <span style="color:#ae81ff">100</span>)
    {
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (bar &gt; <span style="color:#ae81ff">10</span>)
    {
        <span style="color:#66d9ef">var</span> something = WhenIUseAResultVar(bar, foo);
        OutputGuy.Take(something);
    }
    <span style="color:#66d9ef">else</span>
    {
        <span style="color:#66d9ef">var</span> somethingElse = WhenIPipeDataIntoOtherFunctions();
        Printer.Print(somethingElse);
    }
}
</code></pre></div><p>Is this an improvement over alternatives? Not really in my opinion. (Remember I said this was my all about my opinions?) I actually felt worse and worse as I typed out each successive example. (I think I am trying to extract out intent by the above refactorings, but by this point I can&rsquo;t be sure).</p>
<p>Again, with breaking the rule on purpose:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff(<span style="color:#66d9ef">string</span> foo, <span style="color:#66d9ef">int</span> bar)
{
    <span style="color:#66d9ef">if</span> (input1 &lt;= <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2)) <span style="color:#66d9ef">return</span>;
    <span style="color:#66d9ef">if</span> (input2 &gt; <span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">return</span>;
    
    <span style="color:#66d9ef">if</span> (bar &gt; <span style="color:#ae81ff">10</span>)
    {
        <span style="color:#66d9ef">var</span> something = WhenIUseAResultVar(bar, foo);
        OutputGuy.Take(something);
    }
    <span style="color:#66d9ef">else</span>
    {
        <span style="color:#66d9ef">var</span> somethingElse = WhenIPipeDataIntoOtherFunctions();
        Printer.Print(somethingElse);
    }
}
</code></pre></div><p>I&rsquo;m liking this. Get validation out of the way, get on with main logic control flow.</p>
<h3 id="exceptions">Exceptions</h3>
<p>I&rsquo;ve already touched on this. Exceptions break the flow of control.  Exceptions are early returns already. They also shouldn&rsquo;t be actually used for flow of control. So it&rsquo;s probably fine?  And since I am happy with validations performing early return, these fit that case anyway. Consistency! (Phew!)</p>
<p>If my method actually returns Errors as a use case, I opt for something like I do with my <a href="https://github.com/csMACnz/Beefeater" target="_blank">Beefeater</a>
 library and have <code>Result&lt;TValue,TError&gt;</code> response objects, and control flow rule (and early-return-for-validation exception-to-sed-rule)  applies again.</p>
<h3 id="an-extra-section-about-short-circuiting">An extra section about short circuiting</h3>
<p>I&rsquo;ve written these on the assumption that you do not want to evaluate more conditions than you need to.</p>
<p>For instance, to make the <code>WhenIUseAResultVar</code> example more readable we could have pulled the conditional checks into named variables:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> WhenIUseAResultVar(<span style="color:#66d9ef">int</span> input1, <span style="color:#66d9ef">string</span> input2)
{
    <span style="color:#66d9ef">if</span> (input1 &lt;= <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.isNullOrEmpty(input2)) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
    
    <span style="color:#66d9ef">string</span> result;
    
    <span style="color:#66d9ef">var</span> isLargeCase = input2 &gt; <span style="color:#ae81ff">100</span>;
    <span style="color:#66d9ef">var</span> isSmallCase = input1 &gt; <span style="color:#ae81ff">5</span>;
    <span style="color:#66d9ef">if</span> (isLargeCase)
    {
        <span style="color:#66d9ef">string</span> result = <span style="color:#e6db74">&#34;Case 1 Result&#34;</span>;
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (isSmallCase)
    {
        <span style="color:#66d9ef">var</span> part1 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>(<span style="color:#e6db74">&#39;a&#39;</span>, input1);
        result = part1 + <span style="color:#e6db74">&#34; &#34;</span> + input2;
    }
    <span style="color:#66d9ef">else</span>
    {
        result = <span style="color:#e6db74">&#34;Some Fallback Result&#34;</span>;
    }
    
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>This aids readability, but is functionally different to the first example.  Even if <code>isLargeCase</code> is true, we still evaluate and execute <code>isSmallCase</code>. In the original example, <code>isLargeCase</code> being true shortcircuits and stops the evaluation of <code>isSmallCase</code> entirely.  If this was a real example, and <code>isSmallCase</code> required extra database access or web calls, you probably don&rsquo;t want to always evaluate this up front.</p>
<p>Having said that, If the cost of execution is low, and the improvement to readability and comprehensibility is high, Then do it. Also if the condition is that complex, push it out into a method call anyway:</p>
<pre><code>if(theSkyIsBlue(timeOfDay))
{
    ...
}
else if (ASimpleCheckPasses(input1) &amp;&amp; AWebCallCheck(input1, input2))
{
    ....
}
</code></pre><p>(Thanks [Graham Mace}(https://github.com/maceage) for the addition. )</p>
<h3 id="conclusion">Conclusion</h3>
<p>I&rsquo;m not even sure if I have actually convinced myself 100% at this point. Reality is, I have all of these techniques in my tool box, and I will probably pick and choose to enhance readability where applicable. Pragratism usually wins in these matters, but I find it useful to stop and think about concepts like this from time to time.</p>
<p>I was originally prompted to write this after reading the lecterror blog article <a href="http://lecterror.com/articles/view/code-formatting-and-readability" target="_blank">Code formatting and readability</a>
 and related StackOverflow question <a href="http://programmers.stackexchange.com/questions/18454/should-i-return-from-a-function-early-or-use-an-if-statement" target="_blank">Should I return from a function early or use an if statement?</a>
.</p>
<p>(I thought, &ldquo;Hey! I have opinions too! And a Blog!&quot;)</p>
</div><hr /><div class="post-navs d-flex mb-3 justify-content-between">
  <div class="post-nav w-50"><div class="prev-post btn btn-sm">
      <a href="https://csmacnzblog.github.io/post/in-c-your-structs-should-be-immutable/">In C#, your structs should be immutable.</a>
    </div></div>
  <div class="post-nav flex-row-reverse"><div class="next-post btn btn-sm">
      <a href="https://csmacnzblog.github.io/post/typescript-over-javascript-always/">TypeScript over JavaScript, Always</a>
    </div></div>
</div><section class="related-posts">
    <h3>Related Posts</h3>
    <ul class="related-posts"><li><a href="https://csmacnzblog.github.io/post/in-c-your-structs-should-be-immutable/">In C#, your structs should be immutable.</a></li><li><a href="https://csmacnzblog.github.io/post/a-couple-of-debugging-tips/">A couple of debugging tips</a></li><li><a href="https://csmacnzblog.github.io/post/externalannotations-or-how-to-not-depend-on-jetbrains-annotations-dll/">ExternalAnnotations, or how to not depend on jetbrains.annotations.dll</a></li><li><a href="https://csmacnzblog.github.io/post/using-c5-with-visual-studio-2015/">Using C# 5.0 with Visual Studio 2015</a></li><li><a href="https://csmacnzblog.github.io/post/dotnet-build-targeting-full-net451-on-nanoserver-2/">dotnet build, targeting full .Net 4.5.1 on nanoserver docker</a></li></ul>
  </section></article><div class="post-comments surface row"></div></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container"><section class="recent-posts row surface">
  <h4>Recent Posts</h4>
  <ul><li><a href="https://csmacnzblog.github.io/post/terraform-newrelic-provider-facepalm/">Failed to query available provider packages - Terraform NewRelic Provider :facepalm:</a></li><li><a href="https://csmacnzblog.github.io/post/kotlin-teamcity-and-reflection/">Kotlin, TeamCity and reflection</a></li><li><a href="https://csmacnzblog.github.io/post/bluetooth-devices-keep-disconnecting/">Bluetooth Devices keep disconnecting</a></li><li><a href="https://csmacnzblog.github.io/post/nullable-and-notnull-serialisation-properties/">Nullable and notnull Serialisation Properties</a></li><li><a href="https://csmacnzblog.github.io/post/we-are-all-10x/">We are all 10x engineers, but I don&#39;t think it means what you think it means</a></li></ul>
</section><section class="taxonomy-categories row surface">
      <h4>
        <a href="https://csmacnzblog.github.io/categories">Categories</a>
      </h4>
      <div><a href="https://csmacnzblog.github.io/categories/c#/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="c#">
          c# <span class="badge rounded-pill">37</span>
        </a><a href="https://csmacnzblog.github.io/categories/dotnetcore/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="dotnetcore">
          dotnetcore <span class="badge rounded-pill">35</span>
        </a><a href="https://csmacnzblog.github.io/categories/tips-and-tricks/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Tips and Tricks">
          Tips and Tricks <span class="badge rounded-pill">30</span>
        </a><a href="https://csmacnzblog.github.io/categories/editorial/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Editorial">
          Editorial <span class="badge rounded-pill">26</span>
        </a><a href="https://csmacnzblog.github.io/categories/continuous-delivery/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Continuous Delivery">
          Continuous Delivery <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/categories/software-development/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="software development">
          software development <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/categories/projects/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Projects">
          Projects <span class="badge rounded-pill">12</span>
        </a><a href="https://csmacnzblog.github.io/categories/conference/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Conference">
          Conference <span class="badge rounded-pill">9</span>
        </a><a href="https://csmacnzblog.github.io/categories/git/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="git">
          git <span class="badge rounded-pill">8</span>
        </a><a href="https://csmacnzblog.github.io/categories/visual-studio/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Visual Studio">
          Visual Studio <span class="badge rounded-pill">8</span>
        </a></div>
    </section><section class="taxonomy-tags row surface">
      <h4>
        <a href="https://csmacnzblog.github.io/tags">Tags</a>
      </h4>
      <div><a href="https://csmacnzblog.github.io/tags/c#/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="c#">
          c# <span class="badge rounded-pill">37</span>
        </a><a href="https://csmacnzblog.github.io/tags/dotnetcore/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="dotnetcore">
          dotnetcore <span class="badge rounded-pill">35</span>
        </a><a href="https://csmacnzblog.github.io/tags/tips-and-tricks/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Tips and Tricks">
          Tips and Tricks <span class="badge rounded-pill">30</span>
        </a><a href="https://csmacnzblog.github.io/tags/editorial/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Editorial">
          Editorial <span class="badge rounded-pill">26</span>
        </a><a href="https://csmacnzblog.github.io/tags/continuous-delivery/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Continuous Delivery">
          Continuous Delivery <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/tags/software-development/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="software development">
          software development <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/tags/projects/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Projects">
          Projects <span class="badge rounded-pill">12</span>
        </a><a href="https://csmacnzblog.github.io/tags/conference/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Conference">
          Conference <span class="badge rounded-pill">9</span>
        </a><a href="https://csmacnzblog.github.io/tags/git/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="git">
          git <span class="badge rounded-pill">8</span>
        </a><a href="https://csmacnzblog.github.io/tags/visual-studio/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Visual Studio">
          Visual Studio <span class="badge rounded-pill">8</span>
        </a></div>
    </section></div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center"></nav>
<div class="copyright mb-2">
  
</div>
<div class="powered-by mb-2">
  Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> and the <a href="https://github.com/razonyang/hugo-theme-bootstrap" target="_blank">Bootstrap</a> theme.
</div></footer>
<a id="btnScrollToTop" class="btn-scroll-to-top">
  <i class="fas fa-fw fa-chevron-circle-up fa-2x"></i>
</a>
</body>
</html>
