<!DOCTYPE html>
<html lang="en">
    <head>

        <script>
            if(!/blogmigration\.csmac\.nz/.test(window.location.host)) {
                window.location = "https:\/\/blogmigration.csmac.nz";
            }
        </script>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name='author' content='Mark Clearwater, csmacnz@csmac.co.nz'>
        <meta name='language' content='EN'>
        <meta name='medium' content='blog'>

    
        <title>.Net Core Series - Using Multiple Projects - csMACnz&#39;s Blog</title>
        <meta name="description" content="This is a series on the .Net Core 1.0 bits. Looking for .Net Core 2 Series?  Getting Started What&rsquo;s in the box Using Multiple Projects &lt;=(We are here) Testing NuGet Multi-targeting Publishing Portable …">
        <meta name='keywords' content='csMACnz, C Sharp, dotnetcore'>

        
        <meta property="og:type" content="article"/>
        <meta property="og:title" content=".Net Core Series - Using Multiple Projects"/>
        <meta property="og:description" content="This is a series on the .Net Core 1.0 bits. Looking for .Net Core 2 Series?  Getting Started What&rsquo;s in the box Using Multiple Projects &lt;=(We are here) Testing NuGet Multi-targeting Publishing Portable …"/>
        <meta property="og:site_name" content="csMACnz&#39;s Blog"/>
        <meta property="og:url" content="https://blogmigration.csmac.nz/post/dotnetcore-using-multiple-projects/"/>
        <meta property="og:image" content="https://csmac.nz/Content/icon/icon.png"/>

        
        <meta name="twitter:card" content="summary"/>
        <meta name="twitter:title" content=".Net Core Series - Using Multiple Projects"/>
        <meta name="twitter:description" content="This is a series on the .Net Core 1.0 bits. Looking for .Net Core 2 Series?  Getting Started What&rsquo;s in the box Using Multiple Projects &lt;=(We are here) Testing NuGet Multi-targeting Publishing Portable …"/>
        <meta name="twitter:image" content="https://csmac.nz/Content/icon/icon.png"/>
        <meta name="twitter:site" content="@csMACnz"/>
        <meta name="twitter:creator" content="@csMACnz"/>
    

        <link rel="apple-touch-icon-precomposed" href="/images/icon/apple-touch-icon-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/icon/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/icon/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/icon/apple-touch-icon-144x144-precomposed.png">
        <link rel="icon" type="image/png" href="/images/icon/icon.png" />
        <link rel='me' type='text/html' href='https://github.com/csMACnz'>

        <script>
            var d_id  = 'csmacnz',
                g_id  = 'UA-18464866-2',
                g_url = 'auto';
        </script>

        <link rel="stylesheet" type="text/css" href="/css/style.css" />
        <link rel="stylesheet" type="text/css" href="/css/blogstyle.css" />

        <link rel="alternate stylesheet" title="dark-code" type="text/css" href="/css/solarized_dark.css" disabled>
        <link rel="stylesheet" title="light-code" type="text/css" href="/css/github-gist.css" disabled>

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4517187877737982"
        crossorigin="anonymous"></script>

        
        
        <script type="application/ld+json">
        {
            "@context" : "https://schema.org",
            "@type" : "Article",
            "publisher": {
                "@type": "Organization",
                "name": "csMACnz&#x27;s Blog",
                "logo": "https:\/\/blogmigration.csmac.nz\/images\/icon\/apple-touch-icon-144x144-precomposed.png"
            },
            "author": {
                "@type": "Person",
                "name": "Mark Clearwater",
                "image": {
                    "@type": "ImageObject",
                    "url": "//www.gravatar.com/avatar/c97410951ec3738a3fd4a2dfb17a5d9c?d=404&s=250",
                    "width": 440,
                    "height": 295
                },
                "url": "https:\/\/blogmigration.csmac.nz",
                "sameAs": [
                    "https://csmac.nz"
                ]
            },
            "articleSection" : "post",
            "name" : ".Net Core Series - Using Multiple Projects",
            "headline" : ".Net Core Series - Using Multiple Projects",
            "url" : "https:\/\/blogmigration.csmac.nz\/post\/dotnetcore-using-multiple-projects\/",
            "datePublished": "2016-07-18T06:32:53.000Z",
            "dateModified" : "2016-07-18T06:32:53.000Z",
            "image" : {
                "@type": "ImageObject",
                "url": "http:\/\/res.cloudinary.com\/csmacnz\/image\/upload\/c_scale,w_440\/v1486488602\/csMACnzNetCoreSeries_e7uifa.png",
                "width": 440,
                "height": 295
            },
            "keywords" : [ "C Sharp", "dotnetcore" ]
            "description" : "This is a series on the new .Net Core bits.\nIs this article, we create multiple projects and link them all together.",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https:\/\/blogmigration.csmac.nz"
            }
            "inLanguage" : "en-US",
            "author" : "Mark Clearwater",
            "creator" : "Mark Clearwater",
            "accountablePerson" : "Mark Clearwater",
            "copyrightHolder" : "Mark Clearwater",
            "copyrightYear" : "2016",
            "wordCount" : "1203",
        }
        </script>
        
        
        
    </head>
    <body class="blog">
        <div class="page-area">

            <header class="header-area">
                <h1 class="header-area-title">csMACnz</h1>
            </header>
            <nav class="navigation-area header-bar-parent">
                <div class="header-bar header-bar-blog">
                    <ul class="menu">
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz">Home</a></li>
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz/BaconVaders">Bacon Vaders</a></li>
                        <li class="menu-item"><a class="menu-item-content CurrentButton" href="/">Blog</a></li>
                    </ul>
                </div>
            </nav>

            <div id="content" class="content-area">

<!--Page Content Begins-->

<article>
    <div class="content-box" itemscope itemtype=" https://schema.org/Article">
    
        <span class="post-meta"><time datetime="2016-07-18"  itemprop="datePublished">18 Jul 16</time> on <a href="/tags/c-sharp">C Sharp</a>,  <a href="/tags/dotnetcore">dotnetcore</a></span>
    
        <h1 class="post-title" itemprop="headline">.Net Core Series - Using Multiple Projects</h1>
    
        <section class="post-content"  itemprop="articleBody">
            <img class="post-image" src="http://res.cloudinary.com/csmacnz/image/upload/c_scale,w_440/v1486488602/csMACnzNetCoreSeries_e7uifa.png"><p>This is a series on the .Net Core 1.0 bits. Looking for <a href="/dotnetcore2-getting-started">.Net Core 2 Series</a>?</p>
<ul>
<li><a href="/dotnetcore-getting-started">Getting Started</a></li>
<li><a href="/dotnetcore-whats-in-the-box">What&rsquo;s in the box</a></li>
<li>Using Multiple Projects &lt;=(We are here)</li>
<li><a href="/dotnetcore-testing">Testing</a></li>
<li><a href="/dotnetcore-nuget">NuGet</a></li>
<li><a href="/dotnetcore-multi-targeting">Multi-targeting</a></li>
<li><a href="/dotnetcore-publishing-portable-applications">Publishing Portable Applications</a></li>
<li><a href="/dotnetcore-self-contained-applications">Self-contained Applications</a></li>
</ul>
<p>We know how to create new projects, we know how to build and run our application and we know (roughly) what the content in the <code>project.json</code> file means. But most projects tend to either require multiple projects or are actually libraries. We can tackle both of these problems together.</p>
<p>We are going to create and library project, and an application project. We can reference the library from the application, to see how referencing projects work.</p>
<h3 id="file---new-application">File -&gt; New Application</h3>
<p>We should be old pros at this bit so let&rsquo;s go:</p>
<pre><code>mkdir MyNewApp
cd MyNewApp
dotnet new
dotnet restore
dotnet build
dotnet run
</code></pre>
<p>With our new project created, we can move on to something new - Libraries.</p>
<h3 id="file---new-library">File -&gt; New Library</h3>
<p>As well as creating empty console applications (by default), <code>dotnet</code> can also create other things:</p>
<pre><code>Avaiable types for C# :
- Console
- Web
- Lib
- xunittest
</code></pre>
<p>(It was actually spelt out as <em>Avaiable</em> in the help text too&hellip; but <a href="https://github.com/dotnet/cli/pull/3822">I fixed it for you</a>)</p>
<p><em>Just a quick reminder that like most things tooling, the way templates will work going forward is <a href="https://github.com/dotnet/cli/issues/2052">subject to change</a>.</em></p>
<p><code>Web</code> is obviously the ASP.NET core template, which I won&rsquo;t be covering in this series, and the <code>xunittest</code> is a test project, which is the subject of the next article.</p>
<p>We want a Library so will use <code>Lib</code>. To do so we add the <code>-t|--type &lt;TYPE&gt;</code> argument to the command <code>dotnet new</code>.</p>
<pre><code>cd ../
mkdir MyNewLib
cd MyNewLib
dotnet new -t Lib
</code></pre>
<pre><code>Created new C# project in C:\dev\MyProject\MyNewLib.
</code></pre>
<p>But what&rsquo;s the different between <code>Console</code> and <code>Lib</code> I hear you ask? Patience! It&rsquo;s coming up:</p>
<pre><code>{
  &quot;version&quot;: &quot;1.0.0-*&quot;,
  &quot;buildOptions&quot;: {
    &quot;debugType&quot;: &quot;portable&quot;
  },
  &quot;dependencies&quot;: {},
  &quot;frameworks&quot;: {
    &quot;netstandard1.6&quot;: {
      &quot;dependencies&quot;: {
        &quot;NETStandard.Library&quot;: &quot;1.6.0&quot;
      }
    }
  }
}
</code></pre>
<p>For starters, the <code>buildOptions</code> value <code>&quot;emitEntryPoint&quot;: true</code> is not present. This is a library, so it doesn&rsquo;t need an entry point.</p>
<p>And instead of targeting the concrete framework <code>netcoreapp1.0</code>, we instead target the profile of <code>netstandard1.6</code>.</p>
<p>I briefly covered this <a href="/dotnetcore-whats-in-the-box#netstandardlibrary">in the last article</a>. Essentially <code>netcoreapp1.0</code> and possibly .Net <a href="https://www.reddit.com/r/dotnet/comments/4i5v4k/what_comes_after_462/">4.6.3</a> are (currently) the only implementations of NETStandard version 1.6 (+ mono/Xamarin, though which versions are compatible is unknown to me).</p>
<p>If we want our library to be more widely usable, such as by older versions of .Net we can lower this to <code>netstandard1.0</code>, which means all .Net 4.5 or greater runtimes are compatible, plus Windows Phone Silverlight (8.0+8.1). It is worth noting that .Net older than version 4.5 is not compatible with this new NetStandard versioning scheme. So if we want to also target .Net 4.0 or .Net3.5, we will have to add these as other frameworks. (More on this in NuGet and Multi-targeting.)</p>
<p>In our console app last time, we targeted a dependency <code>Microsoft.NETCore.App</code>. This was type <code>platform</code>, and declared a dependency on the runtime for our application.  This time, rather than depend on a runtime, we want to depend on a compatible library version, to provide the contracts to the actual libraries, classes and methods in the framework version we declared above. That is, things like <code>System</code>, <code>System.IO</code>, <code>System.Collections</code>, <code>System.Linq</code> etc etc.</p>
<p>As mentioned at length last time, there is a the NETStandard.Library.  Our library project declares a dependency on <code>&quot;NETStandard.Library&quot;: &quot;1.6.0&quot;</code>. As discussed, this <a href="https://www.nuget.org/packages/NETStandard.Library/">NuGet package</a> contains the library references for all <code>netstandard</code> versions, so even if we were to change to target <code>netstandard1.0</code> the package version stays 1.6. It gives us all of the NuGet packages for all of the system functionality that comes in the framework, by adding only a single dependency. Later on, we might want to come back, and replace this just with the packages we actually use. For now, while we start development, this gets us going quickly.</p>
<p>The last thing missing compared to the Console application is the <code>&quot;imports&quot;: &quot;dnxcore50&quot;</code>. Because this is a compatibility measure, for now (as far as I can tell), I hope we don&rsquo;t need to use it with our library. But if we decide to depend on a package that was built using <code>dnxcore</code>, we might need to add it later.</p>
<p>We can build our library, but of course it cannot be run - its a library.</p>
<pre><code>dotnet build
</code></pre>
<h3 id="ppppppphttpsenwikipediaorgwiki7_ps_military_adage">PPPPPPP(<a href="https://en.wikipedia.org/wiki/7_Ps_(military_adage)">*</a>)</h3>
<p>Before we can reference between the two projects, we probably need something to depend on. We can go into the file <code>Library.cs</code> and make a few changes.</p>
<pre><code>namespace ClassLibrary
{
    public class Class1
    {
        public void Method1()
        {
        }
    }
}
</code></pre>
<p>Change the namespace to match our project name for starters, <code>MyNewLib</code>. Our class can be called <code>Calculator</code>, and we can implement a simple method, <code>Add</code>.</p>
<pre><code>namespace MyNewLib
{
    public class Calculator
    {
        public int Add(int first, int second)
        {
            return first + second;
        }
    }
}
</code></pre>
<p>Now it is a bit more interesting, at least.</p>
<h3 id="project-references">Project References</h3>
<p>To reference a project isn&rsquo;t much different to adding a dependency to a NuGet package. The main difference is that we add <code>&quot;target&quot;: &quot;project&quot;</code> as a property. This is similar to the dependency property <code>&quot;type&quot;: &quot;platform&quot;</code> we saw before used with <code>Microsoft.NETCore.App</code>.</p>
<p>If we add a dependency on our library <code>MyNewLib</code> from our console application <code>MyNewApp</code>, the <code>project.json</code> file in <code>MyNewApp</code> looks like this:</p>
<pre><code>{
  &quot;version&quot;: &quot;1.0.0-*&quot;,
  &quot;buildOptions&quot;: {
    &quot;debugType&quot;: &quot;portable&quot;,
    &quot;emitEntryPoint&quot;: true
  },
  &quot;dependencies&quot;: {},
  &quot;frameworks&quot;: {
    &quot;netcoreapp1.0&quot;: {
      &quot;dependencies&quot;: {
        &quot;Microsoft.NETCore.App&quot;: {
          &quot;type&quot;: &quot;platform&quot;,
          &quot;version&quot;: &quot;1.0.0&quot;
        },
        &quot;MyNewLib&quot;: {
          &quot;target&quot;: &quot;project&quot;
        }
      },
      &quot;imports&quot;: &quot;dnxcore50&quot;
    }
  }
}
</code></pre>
<p>Assuming your &ldquo;MyNewApp&rdquo; and &ldquo;MyNewLib&rdquo; folders appear together in the same parent folder, that should be enough to get this thing going.</p>
<p>Two things to note: Whenever you now build MyNewApp, it will recursively try and build the project MyNewLib. The second thing to note is that <strong>build</strong> doesn&rsquo;t perform a <strong>restore</strong>. You need to make sure that both projects have had <code>dotnet restore</code> called before trying to build the application now. Luckily, it turns out that <code>dotnet restore</code> can be run in the parent folder and all direct child folders with a project.json will be restored.</p>
<p>And we will add some code to make the dependency complete. Open MyNewApp&rsquo;s <code>Program.cs</code> file and add a call to our Calculator.</p>
<pre><code>using System;
using MyNewLib;

namespace ConsoleApplication
{
    public class Program
    {
        public static void Main(string[] args)
        {
            Calculator calc = new Calculator();
            var answer = calc.Add(18, 24);
            Console.WriteLine($&quot;The answer is {answer}.&quot;);
        }
    }
}
</code></pre>
<p>One last thing, since we changed the <code>project.json</code> file, is to run the restore command:</p>
<pre><code>dotnet restore
</code></pre>
<h3 id="build-and-run">Build and Run</h3>
<p>From the MyNewApp folder, we can now build and run our application, including the library code from MyNewLib.</p>
<pre><code>dotnet build
dotnet run
</code></pre>
<p>And we can see from the output that both projects are built and we see the correct output from our application.</p>
<pre><code>Project MyNewLib (.NETStandard,Version=v1.6) was previously compiled. Skipping compilation.
Project MyNewApp2 (.NETCoreApp,Version=v1.0) was previously compiled. Skipping compilation.
The answer is 42.
</code></pre>
<h3 id="up-next">Up Next</h3>
<p>Of course, we don&rsquo;t just want to build and ship code, we want to test it actually works.  Next time we will create a test project, and write some tests against our library code above.</p>
</section>
        
        <section class="share">
            Share: 
            <a class="icon-twitter" href="https://twitter.com/share?text=.Net%20Core%20Series%20-%20Using%20Multiple%20Projects&url=https%3a%2f%2fblogmigration.csmac.nz%2fpost%2fdotnetcore-using-multiple-projects%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <span>Twitter</span>
            </a>
            |
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblogmigration.csmac.nz%2fpost%2fdotnetcore-using-multiple-projects%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <span>Facebook</span>
            </a>
        </section>
    </div>
    <div class="content-box">
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = d_id; 
            var disqus_title = '.Net Core Series - Using Multiple Projects';
            
             
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    </div>
</article>

<!--Page Content Ends-->

            </div><aside class="sidebar-area">

<!--Sidebar Content Begins-->

                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-twitter">Twitter</div>
                    
                    <a class="twitter-timeline" data-lang="en" data-height="510" data-dnt="true" href="https://twitter.com/csMACnz?ref_src=twsrc%5Etfw">Tweets by csMACnz</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-rss">Subscribe</div>
                    
                    <a href="/rssfeeds/" title="csMACnz's Blog">RSS Feeds</a>
                    <a href="https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Ffeeds.feedburner.com%2FcsmacnzBlog" target="_blank" title="csMACnz&amp;#039;s Blog"><img src="https://s3.feedly.com/feedburner/feedly.png" alt="" style="border:0"/></a>
                    <a href="https://feeds.feedburner.com/csmacnzBlog" target="_blank"><img src="https://feeds.feedburner.com/~fc/csmacnzBlog?bg=fabb45&amp;fg=4B4B4B&amp;anim=1" height="26" width="88" style="border:0" alt="" /></a>
                    <br />
                    <a href="https://www.patreon.com/csMACnz" target="_blank"><img src="/images/patreon.png" /></a>
                    
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-xbox">Gamercard</div>
                    

                    <div>
                        <a href="https://www.exophase.com/xbox/user/csMACnz/"><img width="288px" src="https://card.exophase.com/1/1476805.png"></a>
                        <a href="http://steamcommunity.com/id/csMACnz/" target="_blank"><img src="https://www.steamsignature.com/status/english/76561197994712512.png" alt="" title="csMACnz's Steam Profile" /></a>
                    </div>
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-ads">Advertisement</div>
                    
                    <div>
                        
                        <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-4517187877737982"
                            data-ad-slot="3618449993"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                        <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>
                    </div>
                    
                </div>

<!--Sidebar Content Ends-->

            </aside>

            <footer class="footer-area">

            <p>
                Designed and Maintained by Mark Clearwater; Last updated August 2021.
                <!-- This used to be something useful, now it is just a hack I left it to make layout easier but also as a fun reminder for me of what it used to be -->
                <br /><a class="footer-link" >¯\_(ツ)_/¯</a>
            </p>

            </footer>
        </div>

<!--body scripts Begins-->

        
        <script src="/js/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script src="/js/codetoggle.js"></script> 

        
        <script>
            var _gaq = [['_setAccount', g_id], ['_trackPageview']];
            (function (d, t) {
                var g = d.createElement(t), s = d.getElementsByTagName(t)[0];
                g.src = ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js';
                s.parentNode.insertBefore(g, s);
            }(document, 'script'));
        </script>

        <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<!--body scripts Ends-->


<!-------------------------------->
<!--                            -->
<!--  _(\    |@@|               -->
<!-- (__/\__ \--/ __            -->
<!--    \___|----|  |   __      -->
<!--        \ }{ /\ )_ / _\     -->
<!--        /\__/\ \__O (__     -->
<!--       (--/\--)    \__/     -->
<!--       _)(  )(_             -->
<!--      `---''---`            -->
<!--                            -->
<!-- https://github.com/csMACnz -->
<!-------------------------------->

    </body>
</html>
