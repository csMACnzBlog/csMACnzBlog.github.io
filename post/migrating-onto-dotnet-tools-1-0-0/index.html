<!DOCTYPE html>
<html lang="en">
    <head>

        <script>
            if(!/blogmigration\.csmac\.nz/.test(window.location.host)) {
                window.location = "https:\/\/blogmigration.csmac.nz\/post\/migrating-onto-dotnet-tools-1-0-0\/";
            }
        </script>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name='author' content='Mark Clearwater, csmacnz@csmac.co.nz'>
        <meta name='language' content='EN'>
        <meta name='medium' content='blog'>

    
        <title>Migrating onto dotnet tools 1.0.0 - csMACnz&#39;s Blog</title>
        <meta name="description" content="Since Visual Studio 2017 is out, and we have a 1.0.0 tools release for .Net Core, I&rsquo;m going to try and migrate a simple project from the pre-release tooling, onto the new tooling. The biggest difference is that …">
        <meta name='keywords' content='csMACnz, dotnetcore, C Sharp, Visual Studio'>

        
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Migrating onto dotnet tools 1.0.0"/>
        <meta property="og:description" content="Since Visual Studio 2017 is out, and we have a 1.0.0 tools release for .Net Core, I&rsquo;m going to try and migrate a simple project from the pre-release tooling, onto the new tooling. The biggest difference is that …"/>
        <meta property="og:site_name" content="csMACnz&#39;s Blog"/>
        <meta property="og:url" content="https://blogmigration.csmac.nz/post/migrating-onto-dotnet-tools-1-0-0/"/>
        <meta property="og:image" content="https://csmac.nz/Content/icon/icon.png"/>

        
        <meta name="twitter:card" content="summary"/>
        <meta name="twitter:title" content="Migrating onto dotnet tools 1.0.0"/>
        <meta name="twitter:description" content="Since Visual Studio 2017 is out, and we have a 1.0.0 tools release for .Net Core, I&rsquo;m going to try and migrate a simple project from the pre-release tooling, onto the new tooling. The biggest difference is that …"/>
        <meta name="twitter:image" content="https://csmac.nz/Content/icon/icon.png"/>
        <meta name="twitter:site" content="@csMACnz"/>
        <meta name="twitter:creator" content="@csMACnz"/>
    

        <link rel="apple-touch-icon-precomposed" href="/images/icon/apple-touch-icon-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/icon/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/icon/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/icon/apple-touch-icon-144x144-precomposed.png">
        <link rel="icon" type="image/png" href="/images/icon/icon.png" />
        <link rel='me' type='text/html' href='https://github.com/csMACnz'>

        <script>
            var d_id  = 'csmacnz',
                g_id  = 'UA-18464866-2',
                g_url = 'auto';
        </script>

        <link rel="stylesheet" type="text/css" href="/css/style.css" />
        <link rel="stylesheet" type="text/css" href="/css/blogstyle.css" />

        <link rel="alternate stylesheet" title="dark-code" type="text/css" href="/css/solarized_dark.css" disabled>
        <link rel="stylesheet" title="light-code" type="text/css" href="/css/github-gist.css" disabled>

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4517187877737982"
        crossorigin="anonymous"></script>

        
        
        <script type="application/ld+json">
        {
            "@context" : "https://schema.org",
            "@type" : "Article",
            "publisher": {
                "@type": "Organization",
                "name": "csMACnz&#x27;s Blog",
                "logo": "https:\/\/blogmigration.csmac.nz\/images\/icon\/apple-touch-icon-144x144-precomposed.png"
            },
            "author": {
                "@type": "Person",
                "name": "Mark Clearwater",
                "image": {
                    "@type": "ImageObject",
                    "url": "//www.gravatar.com/avatar/c97410951ec3738a3fd4a2dfb17a5d9c?d=404&s=250",
                    "width": 440,
                    "height": 295
                },
                "url": "https:\/\/blogmigration.csmac.nz",
                "sameAs": [
                    "https://csmac.nz"
                ]
            },
            "articleSection" : "post",
            "name" : "Migrating onto dotnet tools 1.0.0",
            "headline" : "Migrating onto dotnet tools 1.0.0",
            "url" : "https:\/\/blogmigration.csmac.nz\/post\/migrating-onto-dotnet-tools-1-0-0\/",
            "datePublished": "2017-03-11T23:52:52.000Z",
            "dateModified" : "2017-03-11T23:52:52.000Z",
            "image" : {
                "@type": "ImageObject",
                "url": "http:\/\/res.cloudinary.com\/csmacnz\/image\/upload\/c_scale,w_440\/v1489322958\/migration_poicns.jpg",
                "width": 440,
                "height": 295
            },
            "keywords" : [ "dotnetcore", "C Sharp", "Visual Studio" ]
            "description" : "Since Visual Studio 2017 is out, and we have a 1.0.0 tools release for .Net Core, I\u0026rsquo;m going to try and migrate a simple project from the pre-release tooling, onto the new tooling.\nThe biggest difference is that instead of using a project.json file, the new tooling now uses a .csproj file instead. It will take a few more posts to go into the differences and re-learn how this works, so for now lets just get something building.",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https:\/\/blogmigration.csmac.nz"
            }
            "inLanguage" : "en-US",
            "author" : "Mark Clearwater",
            "creator" : "Mark Clearwater",
            "accountablePerson" : "Mark Clearwater",
            "copyrightHolder" : "Mark Clearwater",
            "copyrightYear" : "2017",
            "wordCount" : "809",
        }
        </script>
        
        
        
    </head>
    <body class="blog">
        <div class="page-area">

            <header class="header-area">
                <h1 class="header-area-title">csMACnz</h1>
            </header>
            <nav class="navigation-area header-bar-parent">
                <div class="header-bar header-bar-blog">
                    <ul class="menu">
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz">Home</a></li>
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz/BaconVaders">Bacon Vaders</a></li>
                        <li class="menu-item"><a class="menu-item-content CurrentButton" href="/">Blog</a></li>
                    </ul>
                </div>
            </nav>

            <div id="content" class="content-area">

<!--Page Content Begins-->

<article>
    <div class="content-box" itemscope itemtype=" https://schema.org/Article"><span class="post-meta"><time datetime="2017-03-11"  itemprop="datePublished">11 Mar 17</time> in <a href="/categories/software-engineering">Software Engineering</a> on <a href="/tags/dotnetcore">dotnetcore</a>,  <a href="/tags/c-sharp">C Sharp</a>,  <a href="/tags/visual-studio">Visual Studio</a></span>
<h1 class="post-title" itemprop="headline">Migrating onto dotnet tools 1.0.0</h1>
    
        <section class="post-content"  itemprop="articleBody">
            <img class="post-image" src="http://res.cloudinary.com/csmacnz/image/upload/c_scale,w_440/v1489322958/migration_poicns.jpg"><p>Since Visual Studio 2017 is out, and we have a 1.0.0 tools release for .Net Core, I&rsquo;m going to try and migrate a simple project from the pre-release tooling, onto the new tooling.</p>
<p>The biggest difference is that instead of using a <code>project.json</code> file, the new tooling now uses a <code>.csproj</code> file instead.  It will take a few more posts to go into the differences and re-learn how this works, so for now lets just get something building.</p>
<h3 id="a-v-previous-dotnet-new">A v-previous dotnet new</h3>
<p>I have a standard project created with <code>dotnet new</code> in my folder. This is an app (the default when you use <code>new</code> without parameters) and has two files: <code>project.json</code> and <code>program.cs</code>.</p>
<pre><code class="language-cs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace MyNewApp
{
    public class Program
    {
        public static void Main(string[] args)
        {
            Console.WriteLine(&quot;Hello World!&quot;);
            if(!Console.IsInputRedirected){
            Console.ReadKey();
            }
        }
    }
}
</code></pre>
<pre><code class="language-json">{
  &quot;version&quot;: &quot;1.0.0-*&quot;,
  &quot;buildOptions&quot;: {
    &quot;emitEntryPoint&quot;: true,
    &quot;debugType&quot;: &quot;portable&quot;
  },
  &quot;dependencies&quot;: {
    &quot;Microsoft.NETCore.App&quot;: {
      &quot;type&quot;: &quot;platform&quot;,
      &quot;version&quot;: &quot;1.0.0&quot;
    }
  },

  &quot;frameworks&quot;: {
    &quot;netcoreapp1.0&quot;: {
      &quot;imports&quot;: &quot;dnxcore50&quot;
    }
  }
}
</code></pre>
<p>Now that I have VS 2016 installed, I can&rsquo;t build this project. I get an error:</p>
<pre><code>MSBUILD : error MSB1003: Specify a project or solution file. The current working directory does not contain a project or solution file.
</code></pre>
<h3 id="migration">Migration</h3>
<p>Luckily, there is a <code>dotnet migrate</code> command. If you run <code>dotnet help migrate</code> you get some useful usage information:</p>
<pre><code>.NET Migrate Command

Usage: dotnet migrate [arguments] [options]

Arguments:
  &lt;PROJECT_JSON/GLOBAL_JSON/SOLUTION_FILE/PROJECT_DIR&gt;  The path to one of the following:
    - a project.json file to migrate.
    - a global.json file, it will migrate the folders specified in global.json.
    - a solution.sln file, it will migrate the projects referenced in the solution.
    - a directory to migrate, it will recursively search for project.json files to migrate.
Defaults to current directory if nothing is specified.

Options:
  -h|--help                     Show help information
  -t|--template-file            Base MSBuild template to use for migrated app. The default is the project included in dotnet new.
  -v|--sdk-package-version      The version of the sdk package that will be referenced in the migrated app. The default is the version of the sdk in dotnet new.
  -x|--xproj-file               The path to the xproj file to use. Required when there is more than one xproj in a project directory.
  -s|--skip-project-references  Skip migrating project references. By default project references are migrated recursively.
  -r|--report-file              Output migration report to the given file in addition to the console.
  --format-report-file-json     Output migration report file as json rather than user messages.
  --skip-backup                 Skip moving project.json, global.json, and *.xproj to a `backup` directory after successful migration.
</code></pre>
<p>So as you can see, you can migrate a solution, a project, or use a <code>global.json</code> to migrate multiple projects. You can even use <code>-t</code> to migrate as a specific type of project. Since this defaults to the same template used for <code>dotnet new</code>, and that I am running this from the project folder, I can just use <code>dotnet migrate</code>.</p>
<p>This produces the following results:</p>
<pre><code>Project dotnetprevious migration succeeded (C:\dev\temp\dotnetprevious).
Summary
Total Projects: 1
Succeeded Projects: 1
Failed Projects: 0

The project migration has finished. Please visit https://aka.ms/coremigration to report any issues you've encountered or ask for help.
Files backed up to C:\dev\temp\dotnetprevious\backup\
</code></pre>
<p>Let&rsquo;s see where we are:</p>
<pre><code>dotnetprevious
 |-- dotnetprevious.csproj
 |-- Program.cs
 |-- backup
 |    +-- project.json
 |
 +-- obj
      |-- ...
</code></pre>
<p>So we can see that our <code>project.json</code> has been moved out of the way and replaces with a <code>.csproj</code> file. We still have our <code>project.json</code> file to refer to as well, in case anything is missing.</p>
<h3 id="build-it">Build it</h3>
<p>Now we have migrated, we can restore, build and run:</p>
<pre><code class="language-powershell">dotnet restore
dotnet build
dotnet run
</code></pre>
<p>Success!</p>
<pre><code>Hello World!
</code></pre>
<h3 id="the-csproj">The csproj</h3>
<pre><code>&lt;Project Sdk=&quot;Microsoft.NET.Sdk&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp1.0&lt;/TargetFramework&gt;
    &lt;DebugType&gt;portable&lt;/DebugType&gt;
    &lt;AssemblyName&gt;dotnetprevious&lt;/AssemblyName&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;PackageId&gt;dotnetprevious&lt;/PackageId&gt;
    &lt;RuntimeFrameworkVersion&gt;1.0.4&lt;/RuntimeFrameworkVersion&gt;
    &lt;PackageTargetFallback&gt;$(PackageTargetFallback);dnxcore50&lt;/PackageTargetFallback&gt;
  &lt;/PropertyGroup&gt;

&lt;/Project&gt;
</code></pre>
<p>A pretty simple xml file, with a property group for some of the (familiar) properties we might want set on our project. We see that <code>TargetFramework</code> is netcoreapp1.0, which is what makes this a new <code>.csproj</code> vs the older .<code>csproj</code> files.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Simple migration seems to work, and is simple to apply. I am hoping as more complex project migration comes around it is just as easy. Don&rsquo;t forget that <code>-t</code> argument to use the right app, web, lib or test template as you migrate if required.</p>
<p><del>Also be aware that after migration, everyone will have to move to Visual Studio 2017, and the new dotnet 1.0.0 sdk before they can now build and run this now migrated project.</del></p>
<h3 id="update-133">Update (13/3)</h3>
<p>I have since learned that you can safely have all versions installed and running on the same machine. To make this work, just specify the correct sdk version in your global.json file, and the correct version of the sdk will be used.</p>
<pre><code>{
  &quot;projects&quot;: [
    &quot;.&quot;
  ],
  &quot;sdk&quot;: {
    &quot;version&quot;: &quot;1.0.0-preview2-003131&quot;
  }
}
</code></pre>
<p>There is also a separate setting used for <code>launchsettings.json</code>, but I won&rsquo;t give specifics on that since I am unfamiliar with it.</p>
</section>
        
        <section class="share">
            Share: 
            <a class="icon-twitter" href="https://twitter.com/share?text=Migrating%20onto%20dotnet%20tools%201.0.0&url=https%3a%2f%2fblogmigration.csmac.nz%2fpost%2fmigrating-onto-dotnet-tools-1-0-0%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <span>Twitter</span>
            </a>
            |
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblogmigration.csmac.nz%2fpost%2fmigrating-onto-dotnet-tools-1-0-0%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <span>Facebook</span>
            </a>
        </section>
    </div>
    <div class="content-box">
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = d_id; 
            var disqus_title = 'Migrating onto dotnet tools 1.0.0';
            
             
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    </div>
</article>

<!--Page Content Ends-->

            </div><aside class="sidebar-area">

<!--Sidebar Content Begins-->

                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-twitter">Twitter</div>
                    
                    <a class="twitter-timeline" data-lang="en" data-height="510" data-dnt="true" href="https://twitter.com/csMACnz?ref_src=twsrc%5Etfw">Tweets by csMACnz</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-rss">Subscribe</div>
                    
                    <a href="/rssfeeds/" title="csMACnz's Blog">RSS Feeds</a>
                    <a href="https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Ffeeds.feedburner.com%2FcsmacnzBlog" target="_blank" title="csMACnz&amp;#039;s Blog"><img src="https://s3.feedly.com/feedburner/feedly.png" alt="" style="border:0"/></a>
                    <a href="https://feeds.feedburner.com/csmacnzBlog" target="_blank"><img src="https://feeds.feedburner.com/~fc/csmacnzBlog?bg=fabb45&amp;fg=4B4B4B&amp;anim=1" height="26" width="88" style="border:0" alt="" /></a>
                    <br />
                    <a href="https://www.patreon.com/csMACnz" target="_blank"><img src="/images/patreon.png" /></a>
                    
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-xbox">Gamercard</div>
                    

                    <div>
                        <a href="https://www.exophase.com/xbox/user/csMACnz/"><img width="288px" src="https://card.exophase.com/1/1476805.png"></a>
                        <a href="http://steamcommunity.com/id/csMACnz/" target="_blank"><img src="https://www.steamsignature.com/status/english/76561197994712512.png" alt="" title="csMACnz's Steam Profile" /></a>
                    </div>
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-ads">Advertisement</div>
                    
                    <div>
                        
                        <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-4517187877737982"
                            data-ad-slot="3618449993"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                        <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>
                    </div>
                    
                </div>

<!--Sidebar Content Ends-->

            </aside>

            <footer class="footer-area">

            <p>
                Designed and Maintained by Mark Clearwater; Last updated August 2021.
                <!-- This used to be something useful, now it is just a hack I left it to make layout easier but also as a fun reminder for me of what it used to be -->
                <br /><a class="footer-link" >¯\_(ツ)_/¯</a>
            </p>

            </footer>
        </div>

<!--body scripts Begins-->

        
        <script src="/js/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script src="/js/codetoggle.js"></script> 

        
        <script>
            var _gaq = [['_setAccount', g_id], ['_trackPageview']];
            (function (d, t) {
                var g = d.createElement(t), s = d.getElementsByTagName(t)[0];
                g.src = ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js';
                s.parentNode.insertBefore(g, s);
            }(document, 'script'));
        </script>

        <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<!--body scripts Ends-->


<!-------------------------------->
<!--                            -->
<!--  _(\    |@@|               -->
<!-- (__/\__ \--/ __            -->
<!--    \___|----|  |   __      -->
<!--        \ }{ /\ )_ / _\     -->
<!--        /\__/\ \__O (__     -->
<!--       (--/\--)    \__/     -->
<!--       _)(  )(_             -->
<!--      `---''---`            -->
<!--                            -->
<!-- https://github.com/csMACnz -->
<!-------------------------------->

    </body>
</html>
