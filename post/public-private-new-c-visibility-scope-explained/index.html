<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>public, private &amp; new: C# visibility scope explained - csMacnz&#39;s Blog</title><link rel="apple-touch-icon" href="https://csmacnzblog.github.io/images/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="https://csmacnzblog.github.io/images/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="https://csmacnzblog.github.io/images/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="https://csmacnzblog.github.io/images/favicons/manifest.json">
<link rel="icon" href="https://csmacnzblog.github.io/images/favicons/favicon.ico">
<meta name="keywords" content="" />
<meta name="description" content="" /><meta itemprop="name" content="public, private &amp; new: C# visibility scope explained">
<meta itemprop="description" content="I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why.
I couldn&rsquo;t think of a good term to group the concepts of methods, constructors, and classes, so I will refer to these as &lsquo;things&rsquo; for the duration of this post."><meta itemprop="datePublished" content="2015-06-28T10:43:07+00:00" />
<meta itemprop="dateModified" content="2015-06-28T10:43:07+00:00" />
<meta itemprop="wordCount" content="1719">
<meta itemprop="keywords" content="c#," /><meta property="og:title" content="public, private &amp; new: C# visibility scope explained" />
<meta property="og:description" content="I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why.
I couldn&rsquo;t think of a good term to group the concepts of methods, constructors, and classes, so I will refer to these as &lsquo;things&rsquo; for the duration of this post." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://csmacnzblog.github.io/post/public-private-new-c-visibility-scope-explained/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2015-06-28T10:43:07+00:00" />
<meta property="article:modified_time" content="2015-06-28T10:43:07+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="public, private &amp; new: C# visibility scope explained"/>
<meta name="twitter:description" content="I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why.
I couldn&rsquo;t think of a good term to group the concepts of methods, constructors, and classes, so I will refer to these as &lsquo;things&rsquo; for the duration of this post."/>
<link rel=stylesheet href="https://csmacnzblog.github.io/css/bundle.min.ce383e7297312216c2d2ced30574d5a9ae83c451db9f064a454509955ae2462d.css" integrity="sha256-zjg&#43;cpcxIhbC0s7TBXTVqa6DxFHbnwZKRUUJlVriRi0=" crossorigin="anonymous"><script src="https://csmacnzblog.github.io/js/bundle.min.ad6d83537f5b4374c837a12a76422496582e04d1dde91bbb443641ec12c506c6.js" integrity="sha256-rW2DU39bQ3TIN6EqdkIkllguBNHd6Ru7RDZB7BLFBsY=" crossorigin="anonymous"></script>
</head><body><header><nav class="navbar navbar-expand-xl fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://csmacnzblog.github.io">
      <img class="logo" alt="Logo" src="https://csmacnzblog.github.io/images/logo.webp" loading="lazy"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-1 mb-2 mb-lg-0"><form class="search-bar d-flex ms-1" action="https://csmacnzblog.github.io/search">
  <div class="input-group input-group-sm">
    <button class="btn btn-search disabled position-absolute left-0" type="submit"><i class="fas fa-fw fa-search"></i></button>
    <input class="form-control rounded-pill" id="searchQuery" name="q" type="search" aria-label="Search">
  </div>
</form></ul><ul class="navbar-nav me-1 mb-2 mb-lg-0 me-1 ms-auto"><li class="nav-item">
  <a class="nav-link" data-bs-toggle="offcanvas" href="#offcanvasSettings" role="button"
    aria-controls="offcanvasSettings">
    <i class="fas fa-fw fa-sliders-h"></i> Settings
  </a>
</li>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings"
  aria-labelledby="offcanvasSettingsLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" w id="offcanvasSettingsLabel"><i class="fas fa-fw fa-sliders-h"></i> Settings</h5>
    <a role="button" data-bs-dismiss="offcanvas" aria-label="Close">
      <span class="fas fa-2x fa-fw fa-times"></span>
    </a>
  </div>
  <div class="offcanvas-body"><section class="setting">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-adjust"></i> Mode</label>
    </div>
    <div class="col-auto ms-auto">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="modeSwitcher">
      </div>
    </div>
  </form>
</section>
<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <span id="btnPalette" class="btn btn-sm"><i class="fas fa-eye-dropper"></i></span>
    </div>
  </form>
  <div class="container mt-2 visually-hidden" id="palettePicker">
    <div class="btn-group"><button type="button" id="palette-blue" title="Blue" 
          class="btn btn-sm palette bg-blue d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-blue-gray" title="Blue Gray" 
          class="btn btn-sm palette bg-blue-gray d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-brown" title="Brown" 
          class="btn btn-sm palette bg-brown d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-cyan" title="Cyan" 
          class="btn btn-sm palette bg-cyan d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-green" title="Green" 
          class="btn btn-sm palette bg-green d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-indigo" title="Indigo" 
          class="btn btn-sm palette bg-indigo d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-orange" title="Orange" 
          class="btn btn-sm palette bg-orange d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-pink" title="Pink" 
          class="btn btn-sm palette bg-pink d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-purple" title="Purple" 
          class="btn btn-sm palette bg-purple d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-red" title="Red" 
          class="btn btn-sm palette bg-red d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-teal" title="Teal" 
          class="btn btn-sm palette bg-teal d-flex align-items-center justify-content-center">
        </button><button type="button" id="palette-yellow" title="Yellow" 
          class="btn btn-sm palette bg-yellow d-flex align-items-center justify-content-center">
        </button></button>
    </div>
  </div>
</section></div>
</div></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row" aria-label="breadcrumb">
  <ol class="breadcrumb surface"><li class="breadcrumb-item"><a href="https://csmacnzblog.github.io/">Home</a></li><li class="breadcrumb-item"><a href="https://csmacnzblog.github.io/post/">Posts</a></li><li class="breadcrumb-item active">public, private &amp; new: C# visibility scope explained</li></ol>
</nav><article class="post row surface"><div class="post-toolbox">
  <div class="col-12 d-none d-lg-block">
    <a id="sidebarToggler" class="fas fa-fw fa-2x fa-expand-alt" role="button"></a>
  </div>
</div>
<h1 class="post-title my-3">public, private &amp; new: C# visibility scope explained</h1><div class="post-meta mb-3">
  <span class="post-date me-2">
    <i class="fas fa-fw fa-calendar-alt"></i>Jun 28, 2015
  </span>
  <span class="post-reading-time me-2">
    <i class="fas fa-fw fa-coffee"></i>9 min read
  </span>
<a href="https://csmacnzblog.github.io/categories/c#/" class="post-taxonomy">#c#</a><a href="https://csmacnzblog.github.io/tags/c#/" class="post-taxonomy">#c#</a></div>
<a id="btnTOC" class="fas fa-fw fa-2x fa-list-alt position-fixed" data-bs-toggle="offcanvas" href="#offcanvasTOC" aria-controls="offcanvasTOC" role="button">
</a>

<div class="offcanvas offcanvas-end surface" tabindex="-1" id="offcanvasTOC" aria-labelledby="offcanvasTOCLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasTOCLabel">Table Of Contents</h5>
    <a role="button" data-bs-dismiss="offcanvas" aria-label="Close">
      <span class="fas fa-2x fa-fw fa-times"></span>
    </a>
  </div>
  <div class="offcanvas-body">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#public">&lsquo;public&rsquo;</a></li>
        <li><a href="#private">&lsquo;private&rsquo;</a></li>
        <li><a href="#protected">&lsquo;protected&rsquo;</a></li>
        <li><a href="#internal">&lsquo;internal&rsquo;</a></li>
        <li><a href="#internalsvisibleto">InternalsVisibleTo</a></li>
        <li><a href="#the-new-modifier">The &lsquo;new&rsquo; Modifier</a></li>
        <li><a href="#nested-classes">Nested classes</a></li>
        <li><a href="#explicit-interface-implementation">Explicit interface implementation</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li><a href="#notes">Notes</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div><div class="post-content mb-3"><p>I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why.</p>
<p>I couldn&rsquo;t think of a good term to group the concepts of methods, constructors, and classes, so I will refer to these as &lsquo;things&rsquo; for the duration of this post.</p>
<h3 id="public">&lsquo;public&rsquo;</h3>
<p>This is pretty easy. It&rsquo;s <code>public</code>. Anyone can find it and use it if they have your assembly to link to.  This can be used on fields, properties, constructors, methods, classes, whether they are static things or instance things.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> 
{
    <span style="color:#66d9ef">public</span> Foo()
    {
        ...
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> num;
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> FourtyTwo = <span style="color:#ae81ff">42.0</span>;
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }
}

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
{
    ...
}
</code></pre></div><p>probably not worth spending a bunch of time on this. Onto the next one.</p>
<h3 id="private">&lsquo;private&rsquo;</h3>
<p>The <code>private</code> modifier is also not complicated.  The access is restricted to the private scope of the class that holds it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#ae81ff">_</span>num;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> <span style="color:#ae81ff">_f</span>ourtyTwo = <span style="color:#ae81ff">42.0</span>;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> 
    {
        ...
    }

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
    {

    }
}
</code></pre></div><p>Any methods inside the scope of Foo have access to use any of the things marked as private.</p>
<p>This has the effect that if you were to derive from this class, you couldn&rsquo;t access those things that have a private scope.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Derived</span> : Foo 
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
    {
        <span style="color:#75715e">//This method could not make use of _num, GetAFoo, _fourtyTwo, GetABar
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//or the classes Bar or Baz
</span><span style="color:#75715e"></span>    }
}
</code></pre></div><p>The default for most things is private. If you don&rsquo;t declare a modifier, this is most likely what you get. Personally, I never rely on defaults, and always explicitly write private against anything in the code I write. The only exception to this is non-nested classes, which I&rsquo;ll cover in the <code>internal</code> section.</p>
<p>Note that although classes cannot be private, they can if they are nested inside other classes. More on nested classes later on.</p>
<h3 id="protected">&lsquo;protected&rsquo;</h3>
<p>The <code>protected</code> scope can be used in practically all the same places as we use <code>private</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
{
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">int</span> Num;
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> FourtyTwo = <span style="color:#ae81ff">42.0</span>;
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }

    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> 
    {
        ...
    }

    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
    {

    }
}
</code></pre></div><p>The key difference here is that they do become visible to the derived classes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
{
    <span style="color:#75715e">//This method can use Num, GetAFoo, FourtyTwo, GetABar
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//and the classes Bar and Baz
</span><span style="color:#75715e"></span>}
</code></pre></div><p>And like <code>private</code>, no one outside of the scope of the class or it&rsquo;s derived classes can access these things.</p>
<h3 id="internal">&lsquo;internal&rsquo;</h3>
<p>The <code>internal</code> modifier, sits somewhere just below public. It basically says public to all code inside the same assembly. But consider it not available to be directly referenced from outside.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> 
{
    <span style="color:#66d9ef">internal</span> Foo()
    {
    ...
    }

    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">int</span> num;
    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> FourtyTwo = <span style="color:#ae81ff">42.0</span>;
    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }
}

<span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fizz</span>
{
    ...
}
    
<span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Buzz</span>
{
    ...
}
</code></pre></div><p>Unlike <code>private</code> and <code>protected</code>, we can use internal on non-nested classes.  In fact, without a visibility modifier, this is the default of these classes.</p>
<p>There is one feature forced on you when you make a class <code>internal</code>, however. You must not allow any public class to expose that other type. This means that a public property, method, or field cannot use the Type as the property or field type, or as a parameter, or return type of a method.</p>
<h3 id="internalsvisibleto">InternalsVisibleTo</h3>
<p>Now I said that <code>internal</code> means you cannot reference the internal thing from outside the assembly. I am now going to show you how to allow someone to access these from outside the assembly.</p>
<p>Introducing <a href="https://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute%28v=vs.110%29.aspx" target="_blank"><strong>InternalsVisibleToAttribute</strong></a>
!  This attribute can be used to name an assembly that is allowed to access your internals.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#a6e22e">[assembly:InternalsVisibleTo(&#34;Friend1a&#34;)]</span>
</code></pre></div><p>Usually, you might find this in an AssemblyInfo.cs file. We are declaring that someone with an assembly name &ldquo;Friend1a&rdquo; has access to your <code>internal</code>s as if they were <code>public</code>. This can also be used with signed assemblies if required.</p>
<p>Why would you use this? The only case I&rsquo;ve seen that makes sense is testing. Your test assembly will probably want to have tests covering your internal classes with unit tests. This gives them access to do so, without opening up the class to be public. Keep your internal classes hidden from anyone using your assembly, if they should not be using them.</p>
<h3 id="the-new-modifier">The &lsquo;new&rsquo; Modifier</h3>
<p>The <code>new</code> modifier is an interesting keyword. For clarity, I&rsquo;m not talking about these two usages:</p>
<ul>
<li><code>new object()</code></li>
<li><code>public class Foo&lt;T&gt; where T: new() { ... }</code></li>
</ul>
<p>This usage is not one I recommend using, but from time to time, you get a hint that you are hiding a method and should use the new keyword. Let&rsquo;s look at a usage, and talk through the problem.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> GetNumber()
    {
        ...
    }
}
    
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> : Foo
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> GetNumber()
    {
        ...
    }
}
</code></pre></div><p>This generates a compiler warning. Basically, by adding new, we are getting rid of the compiler warning. But now someone reading the code can see that something is happening here, which they wouldn&rsquo;t easily see without the <code>new</code> keyword. There are two placements of the keyword, before or after the visibility modifier.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> : Foo
{
    <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> GetNumber()
    {
        ...
    }
}
    
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> : Foo
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span> GetNumber()
    {
        ...
    }
}
</code></pre></div><p>Usually, this warning is treated as an error and stops compilation.  So why is this bad?  Well, we basically have two versions of our value. One that belongs to Foo, and one that belongs to Bar, both with the same name. When you use that name from Bar, you are referring to the Bar version, when doing in regards to Foo, you mean the Foo version. This just gets damn confusing, and mistakes get made. Not to mention, as you cast back and forward, you toggle between which property gets used. Don&rsquo;t like it. Stop it now.</p>
<p>The correct solution, of course, is to use virtual and override. I&rsquo;m not covering them in this post, but they let you have a single implementation for any instance, and no matter how you reference it, the correct one is used on the instance. Just do it.</p>
<h3 id="nested-classes">Nested classes</h3>
<p>I kind of touched on nested classes with visibility earlier. They can be public, private, protected or internal. That determines its visibility to external and derived classes as described above. Nested classes are private visibility by default. Cool.</p>
<p>Also, their internal things are scoped following the normal rules.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Num;
        <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
            
        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
        {
            ...
        }
    }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
    {
        <span style="color:#66d9ef">var</span> b = <span style="color:#66d9ef">new</span> Bar();
        <span style="color:#66d9ef">var</span> num = b.Num; <span style="color:#75715e">//works, I can see and access public things
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//I can&#39;t use b.GetAFoo() because its protected.
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//I can&#39;t use  new Bar.Baz() because it&#39;s private.
</span><span style="color:#75715e"></span>    }
}
</code></pre></div><p>The fun starts here. We can access anything from inside the parent class while in the code belonging to the nested child. When inside the parent, we can see the parent&rsquo;s insides.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Num;

    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
    {
        ...
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
        {
            <span style="color:#66d9ef">var</span> f = <span style="color:#66d9ef">new</span> Foo();
            <span style="color:#66d9ef">var</span> num = f.Num; <span style="color:#75715e">//works, I can see and access public things.
</span><span style="color:#75715e"></span>            f.GetAFoo(); <span style="color:#75715e">// works, I can see and access Foo protected things.
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">var</span> b = <span style="color:#66d9ef">new</span> Baz(); <span style="color:#75715e">// works, I can see his private things.
</span><span style="color:#75715e"></span>        } 
    }
}
</code></pre></div><p>This is the main benefit of being able to create and use nested classes. Breaking encapsulation.</p>
<h3 id="explicit-interface-implementation">Explicit interface implementation</h3>
<p>The last story of visibility is this idea of explicit interface implementation. Let&rsquo;s use an example with a simple interface.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> IFooable
{
    <span style="color:#66d9ef">int</span> FooIt();
}
</code></pre></div><p>We can implement it normally like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fighter</span> : IFooable
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> FooIt()
    {
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">666</span>;
    }
}
</code></pre></div><p>This is known as implicit implementation. When we talk about explicit interface implementation we mean this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dave</span> : IFooable
{
    <span style="color:#66d9ef">int</span> IFooable.FooIt()
    {
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">666</span>;
    }
}
</code></pre></div><p>So what&rsquo;s the difference? It becomes clear when we use at the usage code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">var</span> fighter = <span style="color:#66d9ef">new</span> Fighter();
fighter.FooIt();
IFooable castedFighter = (IFooable)fighter;
castedFighter.FooIt(); <span style="color:#75715e">//The interface allows you to call this method
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> dave = <span style="color:#66d9ef">new</span> Dave();
<span style="color:#75715e">//dave.FooIt(); //This doesn&#39;t compile, the implementation is hidden
</span><span style="color:#75715e"></span>IFooable castedDave = (IFooable)dave;
castedDave.FooIt(); <span style="color:#75715e">//The interface allows you to call this method
</span></code></pre></div><p>What this gives us is a way to hide the method from the class, but still allow it to meet the expectations of the interface. Why is this useful? If you have name collision on your interfaces or signature mismatches, you can use explicit implementations to implement all of the correct versions against the correct interface without the compiler yelling at you. You might decide to leave one implicit so you can use it on the object, or keep them all explicit.</p>
<p>Two common use cases are <code>IDisposable</code> (hide the <code>Dispose()</code> method unless you explicitly cast to <code>IDisposable</code>) and <code>IList</code> + <code>IList&lt;T&gt;</code>.  This second one has many methods that only differ by the return type, so it&rsquo;s nice to hide the non-generic versions from the long list of interface methods available. You can see this by casting a <code>List&lt;int&gt;</code> to <code>IList</code> or to <code>IEnumerable</code>, and see how the IntelliSense shows you different methods on the two references.</p>
<h2 id="conclusion">Conclusion</h2>
<p>So that&rsquo;s a bunch of stuff around visibility. I Hope that informed and entertained you. Drop me a line if you think I&rsquo;ve missed anything that comes under the visibility umbrella.</p>
<h3 id="notes">Notes</h3>
<p>I use a lot of ellipses in my code. This is just my way of saying more code goes here. It&rsquo;s not a special syntax feature that you haven&rsquo;t seen before, just my shorthand. :) And sorry for all the things. (Please suggest a term to me if a better one exists).</p>
</div><hr /><div class="post-navs d-flex mb-3 justify-content-between">
  <div class="post-nav w-50"><div class="prev-post btn btn-sm">
      <a href="https://csmacnzblog.github.io/post/more-small-classes/">More small classes</a>
    </div></div>
  <div class="post-nav flex-row-reverse"><div class="next-post btn btn-sm">
      <a href="https://csmacnzblog.github.io/post/anchors-links-and-css/">Html anchors, links, and css</a>
    </div></div>
</div></article><div class="post-comments surface row"></div></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container"><section class="recent-posts row surface">
  <h4>Recent Posts</h4>
  <ul><li><a href="https://csmacnzblog.github.io/post/terraform-newrelic-provider-facepalm/">Failed to query available provider packages - Terraform NewRelic Provider :facepalm:</a></li><li><a href="https://csmacnzblog.github.io/post/kotlin-teamcity-and-reflection/">Kotlin, TeamCity and reflection</a></li><li><a href="https://csmacnzblog.github.io/post/bluetooth-devices-keep-disconnecting/">Bluetooth Devices keep disconnecting</a></li><li><a href="https://csmacnzblog.github.io/post/nullable-and-notnull-serialisation-properties/">Nullable and notnull Serialisation Properties</a></li><li><a href="https://csmacnzblog.github.io/post/we-are-all-10x/">We are all 10x engineers, but I don&#39;t think it means what you think it means</a></li></ul>
</section><section class="taxonomy-categories row surface">
      <h4>
        <a href="https://csmacnzblog.github.io/categories">Categories</a>
      </h4>
      <div><a href="https://csmacnzblog.github.io/categories/c#/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="c#">
          c# <span class="badge rounded-pill">37</span>
        </a><a href="https://csmacnzblog.github.io/categories/dotnetcore/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="dotnetcore">
          dotnetcore <span class="badge rounded-pill">35</span>
        </a><a href="https://csmacnzblog.github.io/categories/tips-and-tricks/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Tips and Tricks">
          Tips and Tricks <span class="badge rounded-pill">30</span>
        </a><a href="https://csmacnzblog.github.io/categories/editorial/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Editorial">
          Editorial <span class="badge rounded-pill">26</span>
        </a><a href="https://csmacnzblog.github.io/categories/continuous-delivery/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Continuous Delivery">
          Continuous Delivery <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/categories/software-development/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="software development">
          software development <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/categories/projects/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Projects">
          Projects <span class="badge rounded-pill">12</span>
        </a><a href="https://csmacnzblog.github.io/categories/conference/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Conference">
          Conference <span class="badge rounded-pill">9</span>
        </a><a href="https://csmacnzblog.github.io/categories/git/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="git">
          git <span class="badge rounded-pill">8</span>
        </a><a href="https://csmacnzblog.github.io/categories/visual-studio/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Visual Studio">
          Visual Studio <span class="badge rounded-pill">8</span>
        </a></div>
    </section><section class="taxonomy-tags row surface">
      <h4>
        <a href="https://csmacnzblog.github.io/tags">Tags</a>
      </h4>
      <div><a href="https://csmacnzblog.github.io/tags/c#/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="c#">
          c# <span class="badge rounded-pill">37</span>
        </a><a href="https://csmacnzblog.github.io/tags/dotnetcore/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="dotnetcore">
          dotnetcore <span class="badge rounded-pill">35</span>
        </a><a href="https://csmacnzblog.github.io/tags/tips-and-tricks/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Tips and Tricks">
          Tips and Tricks <span class="badge rounded-pill">30</span>
        </a><a href="https://csmacnzblog.github.io/tags/editorial/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Editorial">
          Editorial <span class="badge rounded-pill">26</span>
        </a><a href="https://csmacnzblog.github.io/tags/continuous-delivery/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Continuous Delivery">
          Continuous Delivery <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/tags/software-development/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="software development">
          software development <span class="badge rounded-pill">13</span>
        </a><a href="https://csmacnzblog.github.io/tags/projects/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Projects">
          Projects <span class="badge rounded-pill">12</span>
        </a><a href="https://csmacnzblog.github.io/tags/conference/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Conference">
          Conference <span class="badge rounded-pill">9</span>
        </a><a href="https://csmacnzblog.github.io/tags/git/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="git">
          git <span class="badge rounded-pill">8</span>
        </a><a href="https://csmacnzblog.github.io/tags/visual-studio/" class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Visual Studio">
          Visual Studio <span class="badge rounded-pill">8</span>
        </a></div>
    </section></div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center"></nav>
<div class="copyright mb-2">
  
</div>
<div class="powered-by mb-2">
  Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> and the <a href="https://github.com/razonyang/hugo-theme-bootstrap" target="_blank">Bootstrap</a> theme.
</div></footer>
<a id="btnScrollToTop" class="btn-scroll-to-top">
  <i class="fas fa-fw fa-chevron-circle-up fa-2x"></i>
</a>
</body>
</html>
