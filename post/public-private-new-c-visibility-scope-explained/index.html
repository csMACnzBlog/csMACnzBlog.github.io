<!DOCTYPE html>
<html lang="en">
    <head>

        <script>
            if(!/blog\.csmac\.nz/.test(window.location.host)) {
                window.location = "https:\/\/blog.csmac.nz\/post\/public-private-new-c-visibility-scope-explained\/";
            }
        </script>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name='author' content='Mark Clearwater, csmacnz@csmac.co.nz'>
        <meta name='language' content='EN'>
        <meta name='medium' content='blog'>
        <meta name="google-adsense-account" content="ca-pub-4517187877737982">

    
        <title>public, private &amp; new: C# visibility scope explained - csMACnz&#39;s Blog</title>
        <meta name="description" content="I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why. I …">
        <meta name='keywords' content='csMACnz, C Sharp'>

        
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="public, private &amp; new: C# visibility scope explained"/>
        <meta property="og:description" content="I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why. I …"/>
        <meta property="og:site_name" content="csMACnz&#39;s Blog"/>
        <meta property="og:url" content="https://blog.csmac.nz/post/public-private-new-c-visibility-scope-explained/"/>
        <meta property="og:image" content="https://csmac.nz/Content/icon/icon.png"/>

        
        <meta name="twitter:card" content="summary"/>
        <meta name="twitter:title" content="public, private &amp; new: C# visibility scope explained"/>
        <meta name="twitter:description" content="I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why. I …"/>
        <meta name="twitter:image" content="https://csmac.nz/Content/icon/icon.png"/>
        <meta name="twitter:site" content="@csMACnz"/>
        <meta name="twitter:creator" content="@csMACnz"/>
    

        <link rel="apple-touch-icon-precomposed" href="/images/icon/apple-touch-icon-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/icon/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/icon/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/icon/apple-touch-icon-144x144-precomposed.png">
        <link rel="icon" type="image/png" href="/images/icon/icon.png" />
        <link rel='me' type='text/html' href='https://github.com/csMACnz'>

        <script>
            var d_id  = 'csmacnz';
        </script>

        <link rel="stylesheet" href="/css/mastodon-timeline.min.css" />

        <link rel="stylesheet" type="text/css" href="/css/style.css" />
        <link rel="stylesheet" type="text/css" href="/css/blogstyle.css" />

        <link rel="alternate stylesheet" title="dark-code" type="text/css" href="/css/solarized_dark.css" disabled>
        <link rel="stylesheet" title="light-code" type="text/css" href="/css/github-gist.css" disabled>

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4517187877737982"
        crossorigin="anonymous"></script>

        
        
        <script type="application/ld+json">
        {
            "@context" : "https://schema.org",
            "@type" : "Article",
            "publisher": {
                "@type": "Organization",
                "name": "csMACnz&#x27;s Blog",
                "logo": "https:\/\/blog.csmac.nz\/images\/icon\/apple-touch-icon-144x144-precomposed.png"
            },
            "author": {
                "@type": "Person",
                "name": "Mark Clearwater",
                "image": {
                    "@type": "ImageObject",
                    "url": "//www.gravatar.com/avatar/c97410951ec3738a3fd4a2dfb17a5d9c?d=404&s=250",
                    "width": 440,
                    "height": 295
                },
                "url": "https:\/\/blog.csmac.nz",
                "sameAs": [
                    "https://csmac.nz"
                ]
            },
            "articleSection" : "post",
            "name" : "public, private \u0026 new: C# visibility scope explained",
            "headline" : "public, private \u0026 new: C# visibility scope explained",
            "url" : "https:\/\/blog.csmac.nz\/post\/public-private-new-c-visibility-scope-explained\/",
            "datePublished": "2015-06-28T10:43:07.000Z",
            "dateModified" : "2015-06-28T10:43:07.000Z",
            "keywords" : [ "C Sharp" ]
            "description" : "I wanted to go over the visibility modifiers in C#. There are a few, it\u0026rsquo;s not as simple as just public or private. Let\u0026rsquo;s go through some scenarios and get our heads around what we can use, when and why.\nI couldn\u0026rsquo;t think of a good term to group the concepts of methods, constructors, and classes, so I will refer to these as \u0026rsquo;things\u0026rsquo; for the duration of this post.",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https:\/\/blog.csmac.nz"
            }
            "inLanguage" : "en-US",
            "author" : "Mark Clearwater",
            "creator" : "Mark Clearwater",
            "accountablePerson" : "Mark Clearwater",
            "copyrightHolder" : "Mark Clearwater",
            "copyrightYear" : "2015",
            "wordCount" : "1718",
        }
        </script>
        
        
        
    </head>
    <body class="blog">
        <div class="page-area">

            <header class="header-area">
                <h1 class="header-area-title">csMACnz</h1>
            </header>
            <nav class="navigation-area header-bar-parent">
                <div class="header-bar header-bar-blog">
                    <ul class="menu">
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz">Home</a></li>
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz/baconvaders">Bacon Vaders</a></li>
                        <li class="menu-item"><a class="menu-item-content CurrentButton" href="https://blog.csmac.nz">Blog</a></li>
                        <li class="menu-item"><a class="menu-item-content" href="https://csmac.nz/metablog">Meta</a></li>
                    </ul>
                </div>
            </nav>

            <div id="content" class="content-area">

<!--Page Content Begins-->

<article>
    <div class="content-box" itemscope itemtype=" https://schema.org/Article"><span class="post-meta"><time datetime="2015-06-28"  itemprop="datePublished">28 Jun 15</time> in <a href="/categories/software-engineering">Software Engineering</a> on <a href="/tags/c-sharp">C Sharp</a></span>
<h1 class="post-title" itemprop="headline">public, private &amp; new: C# visibility scope explained</h1>
    
        <section class="post-content"  itemprop="articleBody">
            <p>I wanted to go over the visibility modifiers in C#. There are a few, it&rsquo;s not as simple as just public or private. Let&rsquo;s go through some scenarios and get our heads around what we can use, when and why.</p>
<p>I couldn&rsquo;t think of a good term to group the concepts of methods, constructors, and classes, so I will refer to these as &rsquo;things&rsquo; for the duration of this post.</p>
<h3 id="public">&lsquo;public&rsquo;</h3>
<p>This is pretty easy. It&rsquo;s <code>public</code>. Anyone can find it and use it if they have your assembly to link to.  This can be used on fields, properties, constructors, methods, classes, whether they are static things or instance things.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Foo()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> num;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> FourtyTwo = <span style="color:#ae81ff">42.0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>probably not worth spending a bunch of time on this. Onto the next one.</p>
<h3 id="private">&lsquo;private&rsquo;</h3>
<p>The <code>private</code> modifier is also not complicated.  The access is restricted to the private scope of the class that holds it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> _num;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> _fourtyTwo = <span style="color:#ae81ff">42.0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Any methods inside the scope of Foo have access to use any of the things marked as private.</p>
<p>This has the effect that if you were to derive from this class, you couldn&rsquo;t access those things that have a private scope.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Derived</span> : Foo 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//This method could not make use of _num, GetAFoo, _fourtyTwo, GetABar</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//or the classes Bar or Baz</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The default for most things is private. If you don&rsquo;t declare a modifier, this is most likely what you get. Personally, I never rely on defaults, and always explicitly write private against anything in the code I write. The only exception to this is non-nested classes, which I&rsquo;ll cover in the <code>internal</code> section.</p>
<p>Note that although classes cannot be private, they can if they are nested inside other classes. More on nested classes later on.</p>
<h3 id="protected">&lsquo;protected&rsquo;</h3>
<p>The <code>protected</code> scope can be used in practically all the same places as we use <code>private</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">int</span> Num;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> FourtyTwo = <span style="color:#ae81ff">42.0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The key difference here is that they do become visible to the derived classes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//This method can use Num, GetAFoo, FourtyTwo, GetABar</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//and the classes Bar and Baz</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And like <code>private</code>, no one outside of the scope of the class or it&rsquo;s derived classes can access these things.</p>
<h3 id="internal">&lsquo;internal&rsquo;</h3>
<p>The <code>internal</code> modifier, sits somewhere just below public. It basically says public to all code inside the same assembly. But consider it not available to be directly referenced from outside.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">internal</span> Foo()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">int</span> num;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">double</span> FourtyTwo = <span style="color:#ae81ff">42.0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> GetABar() { ... }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fizz</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Buzz</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Unlike <code>private</code> and <code>protected</code>, we can use internal on non-nested classes.  In fact, without a visibility modifier, this is the default of these classes.</p>
<p>There is one feature forced on you when you make a class <code>internal</code>, however. You must not allow any public class to expose that other type. This means that a public property, method, or field cannot use the Type as the property or field type, or as a parameter, or return type of a method.</p>
<h3 id="internalsvisibleto">InternalsVisibleTo</h3>
<p>Now I said that <code>internal</code> means you cannot reference the internal thing from outside the assembly. I am now going to show you how to allow someone to access these from outside the assembly.</p>
<p>Introducing <a href="https://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute(v=vs.110).aspx"><strong>InternalsVisibleToAttribute</strong></a>!  This attribute can be used to name an assembly that is allowed to access your internals.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#a6e22e">[assembly:InternalsVisibleTo(&#34;Friend1a&#34;)]</span>
</span></span></code></pre></div><p>Usually, you might find this in an AssemblyInfo.cs file. We are declaring that someone with an assembly name &ldquo;Friend1a&rdquo; has access to your <code>internal</code>s as if they were <code>public</code>. This can also be used with signed assemblies if required.</p>
<p>Why would you use this? The only case I&rsquo;ve seen that makes sense is testing. Your test assembly will probably want to have tests covering your internal classes with unit tests. This gives them access to do so, without opening up the class to be public. Keep your internal classes hidden from anyone using your assembly, if they should not be using them.</p>
<h3 id="the-new-modifier">The &rsquo;new&rsquo; Modifier</h3>
<p>The <code>new</code> modifier is an interesting keyword. For clarity, I&rsquo;m not talking about these two usages:</p>
<ul>
<li><code>new object()</code></li>
<li><code>public class Foo&lt;T&gt; where T: new() { ... }</code></li>
</ul>
<p>This usage is not one I recommend using, but from time to time, you get a hint that you are hiding a method and should use the new keyword. Let&rsquo;s look at a usage, and talk through the problem.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> GetNumber()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> : Foo
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> GetNumber()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This generates a compiler warning. Basically, by adding new, we are getting rid of the compiler warning. But now someone reading the code can see that something is happening here, which they wouldn&rsquo;t easily see without the <code>new</code> keyword. There are two placements of the keyword, before or after the visibility modifier.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> : Foo
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> GetNumber()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> : Foo
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span> GetNumber()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Usually, this warning is treated as an error and stops compilation.  So why is this bad?  Well, we basically have two versions of our value. One that belongs to Foo, and one that belongs to Bar, both with the same name. When you use that name from Bar, you are referring to the Bar version, when doing in regards to Foo, you mean the Foo version. This just gets damn confusing, and mistakes get made. Not to mention, as you cast back and forward, you toggle between which property gets used. Don&rsquo;t like it. Stop it now.</p>
<p>The correct solution, of course, is to use virtual and override. I&rsquo;m not covering them in this post, but they let you have a single implementation for any instance, and no matter how you reference it, the correct one is used on the instance. Just do it.</p>
<h3 id="nested-classes">Nested classes</h3>
<p>I kind of touched on nested classes with visibility earlier. They can be public, private, protected or internal. That determines its visibility to external and derived classes as described above. Nested classes are private visibility by default. Cool.</p>
<p>Also, their internal things are scoped following the normal rules.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Num;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            ...
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> b = <span style="color:#66d9ef">new</span> Bar();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> num = b.Num; <span style="color:#75715e">//works, I can see and access public things</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//I can&#39;t use b.GetAFoo() because its protected.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//I can&#39;t use  new Bar.Baz() because it&#39;s private.</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The fun starts here. We can access anything from inside the parent class while in the code belonging to the nested child. When inside the parent, we can see the parent&rsquo;s insides.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Num;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> GetAFoo() { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Baz</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DoStuff()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> f = <span style="color:#66d9ef">new</span> Foo();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> num = f.Num; <span style="color:#75715e">//works, I can see and access public things.</span>
</span></span><span style="display:flex;"><span>            f.GetAFoo(); <span style="color:#75715e">// works, I can see and access Foo protected things.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> b = <span style="color:#66d9ef">new</span> Baz(); <span style="color:#75715e">// works, I can see his private things.</span>
</span></span><span style="display:flex;"><span>        } 
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This is the main benefit of being able to create and use nested classes. Breaking encapsulation.</p>
<h3 id="explicit-interface-implementation">Explicit interface implementation</h3>
<p>The last story of visibility is this idea of explicit interface implementation. Let&rsquo;s use an example with a simple interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IFooable</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> FooIt();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We can implement it normally like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fighter</span> : IFooable
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> FooIt()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">666</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This is known as implicit implementation. When we talk about explicit interface implementation we mean this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dave</span> : IFooable
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> IFooable.FooIt()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">666</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>So what&rsquo;s the difference? It becomes clear when we use at the usage code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> fighter = <span style="color:#66d9ef">new</span> Fighter();
</span></span><span style="display:flex;"><span>fighter.FooIt();
</span></span><span style="display:flex;"><span>IFooable castedFighter = (IFooable)fighter;
</span></span><span style="display:flex;"><span>castedFighter.FooIt(); <span style="color:#75715e">//The interface allows you to call this method</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> dave = <span style="color:#66d9ef">new</span> Dave();
</span></span><span style="display:flex;"><span><span style="color:#75715e">//dave.FooIt(); //This doesn&#39;t compile, the implementation is hidden</span>
</span></span><span style="display:flex;"><span>IFooable castedDave = (IFooable)dave;
</span></span><span style="display:flex;"><span>castedDave.FooIt(); <span style="color:#75715e">//The interface allows you to call this method</span>
</span></span></code></pre></div><p>What this gives us is a way to hide the method from the class, but still allow it to meet the expectations of the interface. Why is this useful? If you have name collision on your interfaces or signature mismatches, you can use explicit implementations to implement all of the correct versions against the correct interface without the compiler yelling at you. You might decide to leave one implicit so you can use it on the object, or keep them all explicit.</p>
<p>Two common use cases are <code>IDisposable</code> (hide the <code>Dispose()</code> method unless you explicitly cast to <code>IDisposable</code>) and <code>IList</code> + <code>IList&lt;T&gt;</code>.  This second one has many methods that only differ by the return type, so it&rsquo;s nice to hide the non-generic versions from the long list of interface methods available. You can see this by casting a <code>List&lt;int&gt;</code> to <code>IList</code> or to <code>IEnumerable</code>, and see how the IntelliSense shows you different methods on the two references.</p>
<h2 id="conclusion">Conclusion</h2>
<p>So that&rsquo;s a bunch of stuff around visibility. I Hope that informed and entertained you. Drop me a line if you think I&rsquo;ve missed anything that comes under the visibility umbrella.</p>
<h3 id="notes">Notes</h3>
<p>I use a lot of ellipses in my code. This is just my way of saying more code goes here. It&rsquo;s not a special syntax feature that you haven&rsquo;t seen before, just my shorthand. :) And sorry for all the things. (Please suggest a term to me if a better one exists).</p>
</section>
        
        <section class="share">
            Share: 
            <a class="icon-twitter" href="https://twitter.com/share?text=public%2c%20private%20%26%20new%3a%20C%23%20visibility%20scope%20explained&url=https%3a%2f%2fblog.csmac.nz%2fpost%2fpublic-private-new-c-visibility-scope-explained%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <span>Twitter</span>
            </a>
            |
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.csmac.nz%2fpost%2fpublic-private-new-c-visibility-scope-explained%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <span>Facebook</span>
            </a>
        </section>
    </div>
    <div class="content-box">
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = d_id; 
            var disqus_title = 'public, private \u0026 new: C# visibility scope explained';
            
             
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    </div>
</article>

<!--Page Content Ends-->

            </div><aside class="sidebar-area">

<!--Sidebar Content Begins-->

                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-mastodon">Mastodon</div>
                    
                    <div id="mt-container" class="mt-container">
                        <div class="mt-body" role="feed">
                            <div class="mt-loading-spinner"></div>
                        </div>
                    </div>
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-rss">Subscribe</div>
                    
                    <a href="/rssfeeds/" title="csMACnz's Blog">RSS Feeds</a>
                    <a href="https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Ffeeds.feedburner.com%2FcsmacnzBlog" target="_blank" title="csMACnz&amp;#039;s Blog"><img src="https://s3.feedly.com/feedburner/feedly.png" alt="" style="border:0"/></a>
                    <br />
                    <a href="https://www.patreon.com/csMACnz" target="_blank"><img src="/images/patreon.png" /></a>
                    
                    
                </div>


                <div class="header-bar-parent sidebar-item">
                    <div class="header-bar header-bar-xbox">Gamercard</div>
                    

                    <div>
                        <a href="https://www.exophase.com/xbox/user/csMACnz/"><img width="288px" src="https://card.exophase.com/1/1476805.png"></a>
                        <a href="http://steamcommunity.com/id/csMACnz/" target="_blank"><img src="https://www.steamsignature.com/status/english/76561197994712512.png" alt="" title="csMACnz's Steam Profile" /></a>
                    </div>
                    
                </div>

<!--Sidebar Content Ends-->

            </aside>

            <footer class="footer-area">

            <p>
                Designed and Maintained by Mark Clearwater; Last updated November 2023.
                <!-- This used to be something useful, now it is just a hack I left it to make layout easier but also as a fun reminder for me of what it used to be -->
                <br /><a class="footer-link" >¯\_(ツ)_/¯</a>
            </p>

            </footer>
        </div>

<!--body scripts Begins-->

        
        <script src="/js/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script src="/js/codetoggle.js"></script> 

        
        <script src="/js/htmx.min.js"></script>

        
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-08VK9VD3ET"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-08VK9VD3ET');
        </script>

        <script src="/js/mastodon-timeline.min.js"></script>
        <script>
            const myTimeline = new MastodonTimeline({
                instanceUrl: "https://mastodon.nz",
                timelineType: "profile",
                userId: "109867048963758953",
                profileName: "@csMACnz",
                maxNbPostShow: 10,
                hideReblog: true,
            });

        </script>

        <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<!--body scripts Ends-->


<!-------------------------------->
<!--                            -->
<!--  _(\    |@@|               -->
<!-- (__/\__ \--/ __            -->
<!--    \___|----|  |   __      -->
<!--        \ }{ /\ )_ / _\     -->
<!--        /\__/\ \__O (__     -->
<!--       (--/\--)    \__/     -->
<!--       _)(  )(_             -->
<!--      `---''---`            -->
<!--                            -->
<!-- https://github.com/csMACnz -->
<!-------------------------------->

    </body>
</html>
